{"ast":null,"code":"var _jsxFileName = \"/home/devbox/project/src/components/features/ai-chat/ai-chat.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Button } from '../../ui/button';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from './message-bubble';\nimport ThinkingIndicator from './thinking-indicator';\nimport { toast } from 'sonner';\n\n// 定义消息类型\n\n// 定义AI模型类型\n\n// 定义AI模式类型\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AIChat = ({\n  initialMessages = [],\n  onSendMessage\n}) => {\n  _s();\n  const [messages, setMessages] = useState(initialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [status, setStatus] = useState('idle');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [selectedModel, setSelectedModel] = useState('claude-3.7-sonnet');\n  const [mode, setMode] = useState('agent');\n  const [isModelDropdownOpen, setIsModelDropdownOpen] = useState(false);\n  const [references, setReferences] = useState([]);\n  const [showReferenceSelector, setShowReferenceSelector] = useState(false);\n  const [availableFiles, setAvailableFiles] = useState(['workspace.txt', 'project.json', 'README.md', 'src/components/features/plan-tree/plan-tree.tsx']);\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n  const dropdownRef = useRef(null);\n\n  // 处理点击外部关闭下拉菜单\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n        setIsModelDropdownOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n\n  // 自动调整输入框高度\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 200)}px`;\n    }\n  }, [inputValue]);\n  const generateId = () => {\n    return Date.now().toString(36) + Math.random().toString(36).substring(2);\n  };\n  const handleSendMessage = async () => {\n    if (!inputValue.trim() || status !== 'idle') return;\n\n    // 创建用户消息\n    const userMessage = {\n      id: generateId(),\n      role: 'user',\n      content: inputValue,\n      timestamp: new Date(),\n      references: references.length > 0 ? [...references] : undefined\n    };\n\n    // 更新状态并清空输入\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setReferences([]);\n    setShowReferenceSelector(false);\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n    }\n    setStatus('thinking');\n    try {\n      // 如果没有提供onSendMessage回调，使用模拟响应\n      const response = onSendMessage ? await onSendMessage(inputValue, references) : await simulateResponse(inputValue, references);\n\n      // 添加AI回复\n      const assistantMessage = {\n        id: generateId(),\n        role: 'assistant',\n        content: response,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n      setStatus('idle');\n    } catch (error) {\n      console.error('Failed to get AI response:', error);\n      setStatus('error');\n\n      // 添加错误消息\n      const errorMessage = {\n        id: generateId(),\n        role: 'system',\n        content: '抱歉，发生了错误。请稍后再试。',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, errorMessage]);\n      setTimeout(() => setStatus('idle'), 3000);\n    }\n  };\n\n  // 模拟AI响应，仅用于演示\n  const simulateResponse = async (message, refs) => {\n    // 返回模拟的响应\n    return new Promise(resolve => {\n      const responses = [\"我理解你的问题。让我帮你分析一下...\", \"这是一个很好的问题。根据我的分析...\", \"我可以协助你解决这个问题。首先，你需要...\", \"让我思考一下最佳的解决方案。\", \"根据最新的研究和最佳实践，我建议...\"];\n      let response = responses[Math.floor(Math.random() * responses.length)];\n      response += ` 你的问题是关于\"${message}\"的。`;\n\n      // 如果有引用文件，添加相关内容\n      if (refs && refs.length > 0) {\n        response += ` 我已查看了你引用的文件: ${refs.join(', ')}。`;\n      }\n      if (mode === 'agent') {\n        response += \" 作为智能体模式，我会主动帮你执行任务和提供解决方案。\";\n      } else {\n        response += \" 作为对话模式，我会回答你的问题，但不会主动执行任务。\";\n      }\n\n      // 模拟网络延迟\n      setTimeout(() => {\n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 处理输入值变化\n  const handleInputChange = e => {\n    const value = e.target.value;\n    setInputValue(value);\n\n    // 检测是否输入了@符号\n    if (value.endsWith('@') && !showReferenceSelector) {\n      setShowReferenceSelector(true);\n    }\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    } else if (e.key === '@') {\n      setShowReferenceSelector(true);\n    } else if (e.key === 'Escape') {\n      setShowReferenceSelector(false);\n      setIsModelDropdownOpen(false);\n    }\n  };\n  const toggleTheme = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n  const handleReferenceSelect = file => {\n    if (!references.includes(file)) {\n      setReferences(prev => [...prev, file]);\n      toast.success(`已引用 ${file}`);\n    }\n    setShowReferenceSelector(false);\n  };\n  const handleRemoveReference = file => {\n    setReferences(prev => prev.filter(ref => ref !== file));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex flex-col h-full ${isDarkMode ? 'bg-gray-900 text-gray-200' : 'bg-white text-gray-800'}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `px-3 py-2.5 flex justify-between items-center ${isDarkMode ? 'bg-gray-800 border-b border-gray-700' : 'bg-gray-50 border-b border-gray-200'}`,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative mr-2\",\n          ref: dropdownRef,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `h-7 text-xs rounded flex items-center px-2 ${isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'}`,\n            onClick: () => setIsModelDropdownOpen(!isModelDropdownOpen),\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3.5 h-3.5 mr-1.5\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 15\n            }, this), selectedModel, /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3 h-3 ml-1\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M19 9l-7 7-7-7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), isModelDropdownOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `absolute left-0 mt-1 w-48 rounded-md shadow-lg z-10 ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"py-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'claude-3.7-sonnet' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('claude-3.7-sonnet');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"claude-3.7-sonnet\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'claude-3-opus' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('claude-3-opus');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"claude-3-opus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'gpt-4' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('gpt-4');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"gpt-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `rounded-md ${isDarkMode ? 'bg-gray-700 border border-gray-600' : 'bg-white border border-gray-300'} p-0.5 flex text-xs h-7`,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setMode('agent'),\n            className: `px-2 py-1 rounded-sm ${mode === 'agent' ? isDarkMode ? 'bg-gray-600 text-white' : 'bg-blue-100 text-blue-700' : isDarkMode ? 'text-gray-300' : 'text-gray-700'}`,\n            children: \"\\u667A\\u80FD\\u4F53\\u6A21\\u5F0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setMode('chat'),\n            className: `px-2 py-1 rounded-sm ${mode === 'chat' ? isDarkMode ? 'bg-gray-600 text-white' : 'bg-blue-100 text-blue-700' : isDarkMode ? 'text-gray-300' : 'text-gray-700'}`,\n            children: \"\\u5BF9\\u8BDD\\u6A21\\u5F0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-1.5\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `h-7 w-7 rounded flex items-center justify-center ${isDarkMode ? 'hover:bg-gray-700 text-gray-400 hover:text-gray-200' : 'hover:bg-gray-200 text-gray-500 hover:text-gray-700'}`,\n          onClick: () => setMessages(initialMessages),\n          \"aria-label\": \"\\u6E05\\u9664\\u5BF9\\u8BDD\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `h-7 w-7 rounded flex items-center justify-center ${isDarkMode ? 'hover:bg-gray-700 text-gray-400 hover:text-gray-200' : 'hover:bg-gray-200 text-gray-500 hover:text-gray-700'}`,\n          onClick: toggleTheme,\n          \"aria-label\": isDarkMode ? \"切换到亮色模式\" : \"切换到暗色模式\",\n          children: isDarkMode ? /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `flex-1 overflow-y-auto ${isDarkMode ? 'bg-gray-900' : 'bg-white'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-4 space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(AnimatePresence, {\n          children: [messages.map(message => /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              opacity: 0,\n              y: 10\n            },\n            animate: {\n              opacity: 1,\n              y: 0\n            },\n            transition: {\n              duration: 0.3\n            },\n            className: \"max-w-full\",\n            children: /*#__PURE__*/_jsxDEV(MessageBubble, {\n              message: message,\n              isDarkMode: isDarkMode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 17\n            }, this)\n          }, message.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 15\n          }, this)), status === 'thinking' && /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              opacity: 0\n            },\n            animate: {\n              opacity: 1\n            },\n            exit: {\n              opacity: 0\n            },\n            className: \"max-w-full\",\n            children: /*#__PURE__*/_jsxDEV(ThinkingIndicator, {\n              isDarkMode: isDarkMode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `px-3 pt-2 pb-3 ${isDarkMode ? 'bg-gray-900 border-t border-gray-800' : 'bg-white border-t border-gray-100'}`,\n      children: [references.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex flex-wrap gap-1 mb-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs mt-0.5\",\n          children: \"\\u5F15\\u7528\\u6587\\u4EF6:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 13\n        }, this), references.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `text-xs rounded px-1.5 py-0.5 flex items-center ${isDarkMode ? 'bg-blue-900 text-blue-200' : 'bg-blue-100 text-blue-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: file\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRemoveReference(file),\n            className: \"ml-1 text-opacity-70 hover:text-opacity-100\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3 h-3\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M6 18L18 6M6 6l12 12\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 411,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 17\n          }, this)]\n        }, file, true, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `rounded-lg overflow-hidden ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-300'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: inputRef,\n          value: inputValue,\n          onChange: handleInputChange,\n          onKeyDown: handleKeyDown,\n          placeholder: `向 AI 助手提问... (按 @ 引用文件)`,\n          disabled: status !== 'idle',\n          className: `w-full px-3 py-2.5 resize-none outline-none ${isDarkMode ? 'bg-gray-800 text-gray-200 placeholder-gray-500' : 'bg-white text-gray-800 placeholder-gray-400'}`,\n          rows: 1,\n          style: {\n            minHeight: '44px',\n            maxHeight: '200px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex justify-between items-center px-3 py-2 ${isDarkMode ? 'bg-gray-800 border-t border-gray-700' : 'bg-gray-50 border-t border-gray-200'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500\",\n              children: \"\\u6309 Enter \\u53D1\\u9001\\uFF0CShift+Enter \\u6362\\u884C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowReferenceSelector(!showReferenceSelector),\n              className: `text-xs flex items-center ${isDarkMode ? 'text-gray-400 hover:text-gray-300' : 'text-gray-600 hover:text-gray-700'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-3.5 h-3.5 mr-1\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 460,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 459,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u5F15\\u7528\\u6587\\u4EF6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 462,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleSendMessage,\n            disabled: !inputValue.trim() || status !== 'idle',\n            className: `h-7 px-3 text-sm font-medium ${!inputValue.trim() || status !== 'idle' ? 'opacity-50 cursor-not-allowed' : ''} ${isDarkMode ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`,\n            children: \"\\u53D1\\u9001\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this), showReferenceSelector && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `mt-1 rounded-md border ${isDarkMode ? 'border-gray-700 bg-gray-800' : 'border-gray-300 bg-white'} max-h-48 overflow-y-auto shadow-lg`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs font-medium mb-2 px-2\",\n            children: \"\\u9009\\u62E9\\u8981\\u5F15\\u7528\\u7684\\u6587\\u4EF6\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: availableFiles.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `px-3 py-1.5 text-xs rounded cursor-pointer ${isDarkMode ? 'hover:bg-gray-700' : 'hover:bg-gray-100'}`,\n              onClick: () => handleReferenceSelect(file),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: \"w-3.5 h-3.5 mr-2 text-gray-500\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    strokeWidth: 2,\n                    d: \"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 506,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 23\n                }, this), file]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 21\n              }, this)\n            }, file, false, {\n              fileName: _jsxFileName,\n              lineNumber: 495,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 11\n      }, this), status === 'error' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-red-500 mt-1 ml-2\",\n        children: \"\\u53D1\\u9001\\u5931\\u8D25\\uFF0C\\u8BF7\\u91CD\\u8BD5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 5\n  }, this);\n};\n_s(AIChat, \"j8sFwUYutOrQ74FP9QRLywH4Fa0=\");\n_c = AIChat;\nexport default AIChat;\nvar _c;\n$RefreshReg$(_c, \"AIChat\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Button","motion","AnimatePresence","MessageBubble","ThinkingIndicator","toast","jsxDEV","_jsxDEV","AIChat","initialMessages","onSendMessage","_s","messages","setMessages","inputValue","setInputValue","status","setStatus","isDarkMode","setIsDarkMode","selectedModel","setSelectedModel","mode","setMode","isModelDropdownOpen","setIsModelDropdownOpen","references","setReferences","showReferenceSelector","setShowReferenceSelector","availableFiles","setAvailableFiles","messagesEndRef","inputRef","dropdownRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","scrollIntoView","behavior","style","height","Math","min","scrollHeight","generateId","Date","now","toString","random","substring","handleSendMessage","trim","userMessage","id","role","content","timestamp","length","undefined","prev","response","simulateResponse","assistantMessage","error","console","errorMessage","setTimeout","message","refs","Promise","resolve","responses","floor","join","handleInputChange","e","value","endsWith","handleKeyDown","key","shiftKey","preventDefault","toggleTheme","handleReferenceSelect","file","includes","success","handleRemoveReference","filter","ref","className","children","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","map","div","initial","opacity","y","animate","transition","duration","exit","onChange","onKeyDown","placeholder","disabled","rows","minHeight","maxHeight","_c","$RefreshReg$"],"sources":["/home/devbox/project/src/components/features/ai-chat/ai-chat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Button } from '../../ui/button';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from './message-bubble';\nimport ThinkingIndicator from './thinking-indicator';\nimport { toast } from 'sonner';\n\n// 定义消息类型\nexport interface Message {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n  references?: string[]; // 引用的文件或资源\n}\n\n// 定义AI模型类型\ntype AIModel = 'claude-3.7-sonnet' | 'claude-3-opus' | 'gpt-4'; \n\n// 定义AI模式类型\ntype AIMode = 'agent' | 'chat';\n\ninterface AIChatProps {\n  initialMessages?: Message[];\n  onSendMessage?: (message: string, references?: string[]) => Promise<string>;\n}\n\nconst AIChat: React.FC<AIChatProps> = ({ \n  initialMessages = [], \n  onSendMessage \n}) => {\n  const [messages, setMessages] = useState<Message[]>(initialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [status, setStatus] = useState<'idle' | 'thinking' | 'responding' | 'error'>('idle');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [selectedModel, setSelectedModel] = useState<AIModel>('claude-3.7-sonnet');\n  const [mode, setMode] = useState<AIMode>('agent');\n  const [isModelDropdownOpen, setIsModelDropdownOpen] = useState(false);\n  const [references, setReferences] = useState<string[]>([]);\n  const [showReferenceSelector, setShowReferenceSelector] = useState(false);\n  const [availableFiles, setAvailableFiles] = useState([\n    'workspace.txt', \n    'project.json', \n    'README.md', \n    'src/components/features/plan-tree/plan-tree.tsx'\n  ]);\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  \n  // 处理点击外部关闭下拉菜单\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsModelDropdownOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages]);\n\n  // 自动调整输入框高度\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 200)}px`;\n    }\n  }, [inputValue]);\n\n  const generateId = () => {\n    return Date.now().toString(36) + Math.random().toString(36).substring(2);\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim() || status !== 'idle') return;\n    \n    // 创建用户消息\n    const userMessage: Message = {\n      id: generateId(),\n      role: 'user',\n      content: inputValue,\n      timestamp: new Date(),\n      references: references.length > 0 ? [...references] : undefined\n    };\n    \n    // 更新状态并清空输入\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setReferences([]);\n    setShowReferenceSelector(false);\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n    }\n    setStatus('thinking');\n    \n    try {\n      // 如果没有提供onSendMessage回调，使用模拟响应\n      const response = onSendMessage \n        ? await onSendMessage(inputValue, references) \n        : await simulateResponse(inputValue, references);\n      \n      // 添加AI回复\n      const assistantMessage: Message = {\n        id: generateId(),\n        role: 'assistant',\n        content: response,\n        timestamp: new Date()\n      };\n      \n      setMessages(prev => [...prev, assistantMessage]);\n      setStatus('idle');\n    } catch (error) {\n      console.error('Failed to get AI response:', error);\n      setStatus('error');\n      \n      // 添加错误消息\n      const errorMessage: Message = {\n        id: generateId(),\n        role: 'system',\n        content: '抱歉，发生了错误。请稍后再试。',\n        timestamp: new Date()\n      };\n      \n      setMessages(prev => [...prev, errorMessage]);\n      setTimeout(() => setStatus('idle'), 3000);\n    }\n  };\n\n  // 模拟AI响应，仅用于演示\n  const simulateResponse = async (message: string, refs?: string[]): Promise<string> => {\n    // 返回模拟的响应\n    return new Promise((resolve) => {\n      const responses = [\n        \"我理解你的问题。让我帮你分析一下...\",\n        \"这是一个很好的问题。根据我的分析...\",\n        \"我可以协助你解决这个问题。首先，你需要...\",\n        \"让我思考一下最佳的解决方案。\",\n        \"根据最新的研究和最佳实践，我建议...\"\n      ];\n      \n      let response = responses[Math.floor(Math.random() * responses.length)];\n      response += ` 你的问题是关于\"${message}\"的。`;\n      \n      // 如果有引用文件，添加相关内容\n      if (refs && refs.length > 0) {\n        response += ` 我已查看了你引用的文件: ${refs.join(', ')}。`;\n      }\n      \n      if (mode === 'agent') {\n        response += \" 作为智能体模式，我会主动帮你执行任务和提供解决方案。\";\n      } else {\n        response += \" 作为对话模式，我会回答你的问题，但不会主动执行任务。\";\n      }\n      \n      // 模拟网络延迟\n      setTimeout(() => {\n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 处理输入值变化\n  const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const value = e.target.value;\n    setInputValue(value);\n    \n    // 检测是否输入了@符号\n    if (value.endsWith('@') && !showReferenceSelector) {\n      setShowReferenceSelector(true);\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    } else if (e.key === '@') {\n      setShowReferenceSelector(true);\n    } else if (e.key === 'Escape') {\n      setShowReferenceSelector(false);\n      setIsModelDropdownOpen(false);\n    }\n  };\n\n  const toggleTheme = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n  \n  const handleReferenceSelect = (file: string) => {\n    if (!references.includes(file)) {\n      setReferences(prev => [...prev, file]);\n      toast.success(`已引用 ${file}`);\n    }\n    setShowReferenceSelector(false);\n  };\n  \n  const handleRemoveReference = (file: string) => {\n    setReferences(prev => prev.filter(ref => ref !== file));\n  };\n\n  return (\n    <div className={`flex flex-col h-full ${isDarkMode ? 'bg-gray-900 text-gray-200' : 'bg-white text-gray-800'}`}>\n      {/* Cursor风格头部 */}\n      <div className={`px-3 py-2.5 flex justify-between items-center ${isDarkMode ? 'bg-gray-800 border-b border-gray-700' : 'bg-gray-50 border-b border-gray-200'}`}>\n        <div className=\"flex items-center\">\n          {/* 模型选择下拉菜单 */}\n          <div className=\"relative mr-2\" ref={dropdownRef}>\n            <button \n              className={`h-7 text-xs rounded flex items-center px-2 ${\n                isDarkMode \n                  ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' \n                  : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'\n              }`}\n              onClick={() => setIsModelDropdownOpen(!isModelDropdownOpen)}\n            >\n              <svg className=\"w-3.5 h-3.5 mr-1.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n              </svg>\n              {selectedModel}\n              <svg className=\"w-3 h-3 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n              </svg>\n            </button>\n            \n            {isModelDropdownOpen && (\n              <div className={`absolute left-0 mt-1 w-48 rounded-md shadow-lg z-10 ${\n                isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'\n              }`}>\n                <div className=\"py-1\">\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'claude-3.7-sonnet' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('claude-3.7-sonnet');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    claude-3.7-sonnet\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'claude-3-opus' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('claude-3-opus');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    claude-3-opus\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'gpt-4' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('gpt-4');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    gpt-4\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* 模式切换按钮组 */}\n          <div className={`rounded-md ${\n            isDarkMode \n              ? 'bg-gray-700 border border-gray-600' \n              : 'bg-white border border-gray-300'\n          } p-0.5 flex text-xs h-7`}>\n            <button\n              onClick={() => setMode('agent')}\n              className={`px-2 py-1 rounded-sm ${\n                mode === 'agent' \n                  ? (isDarkMode ? 'bg-gray-600 text-white' : 'bg-blue-100 text-blue-700') \n                  : (isDarkMode ? 'text-gray-300' : 'text-gray-700')\n              }`}\n            >\n              智能体模式\n            </button>\n            <button\n              onClick={() => setMode('chat')}\n              className={`px-2 py-1 rounded-sm ${\n                mode === 'chat' \n                  ? (isDarkMode ? 'bg-gray-600 text-white' : 'bg-blue-100 text-blue-700') \n                  : (isDarkMode ? 'text-gray-300' : 'text-gray-700')\n              }`}\n            >\n              对话模式\n            </button>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-1.5\">\n          {/* 清除对话按钮 */}\n          <button \n            className={`h-7 w-7 rounded flex items-center justify-center ${\n              isDarkMode \n                ? 'hover:bg-gray-700 text-gray-400 hover:text-gray-200' \n                : 'hover:bg-gray-200 text-gray-500 hover:text-gray-700'\n            }`}\n            onClick={() => setMessages(initialMessages)}\n            aria-label=\"清除对话\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n            </svg>\n          </button>\n          \n          {/* 主题切换按钮 */}\n          <button \n            className={`h-7 w-7 rounded flex items-center justify-center ${\n              isDarkMode \n                ? 'hover:bg-gray-700 text-gray-400 hover:text-gray-200' \n                : 'hover:bg-gray-200 text-gray-500 hover:text-gray-700'\n            }`}\n            onClick={toggleTheme}\n            aria-label={isDarkMode ? \"切换到亮色模式\" : \"切换到暗色模式\"}\n          >\n            {isDarkMode ? (\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\n              </svg>\n            ) : (\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\n              </svg>\n            )}\n          </button>\n        </div>\n      </div>\n      \n      {/* 消息历史区域 - Cursor风格 */}\n      <div className={`flex-1 overflow-y-auto ${isDarkMode ? 'bg-gray-900' : 'bg-white'}`}>\n        <div className=\"px-4 py-4 space-y-6\">\n          <AnimatePresence>\n            {messages.map((message) => (\n              <motion.div\n                key={message.id}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.3 }}\n                className=\"max-w-full\"\n              >\n                <MessageBubble message={message} isDarkMode={isDarkMode} />\n              </motion.div>\n            ))}\n            \n            {status === 'thinking' && (\n              <motion.div\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                className=\"max-w-full\"\n              >\n                <ThinkingIndicator isDarkMode={isDarkMode} />\n              </motion.div>\n            )}\n          </AnimatePresence>\n          \n          {/* 用于自动滚动的引用元素 */}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n      \n      {/* 底部输入区域 - Cursor风格 */}\n      <div className={`px-3 pt-2 pb-3 ${\n        isDarkMode \n          ? 'bg-gray-900 border-t border-gray-800' \n          : 'bg-white border-t border-gray-100'\n      }`}>\n        {/* 显示已选择的引用文件 */}\n        {references.length > 0 && (\n          <div className={`flex flex-wrap gap-1 mb-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}`}>\n            <span className=\"text-xs mt-0.5\">引用文件:</span>\n            {references.map(file => (\n              <div \n                key={file} \n                className={`text-xs rounded px-1.5 py-0.5 flex items-center ${\n                  isDarkMode \n                    ? 'bg-blue-900 text-blue-200' \n                    : 'bg-blue-100 text-blue-800'\n                }`}\n              >\n                <span>{file}</span>\n                <button \n                  onClick={() => handleRemoveReference(file)}\n                  className=\"ml-1 text-opacity-70 hover:text-opacity-100\"\n                >\n                  <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n        \n        <div className={`rounded-lg overflow-hidden ${\n          isDarkMode \n            ? 'bg-gray-800 border border-gray-700' \n            : 'bg-white border border-gray-300'\n        }`}>\n          {/* 文本输入区域 */}\n          <textarea\n            ref={inputRef}\n            value={inputValue}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder={`向 AI 助手提问... (按 @ 引用文件)`}\n            disabled={status !== 'idle'}\n            className={`w-full px-3 py-2.5 resize-none outline-none ${\n              isDarkMode \n                ? 'bg-gray-800 text-gray-200 placeholder-gray-500' \n                : 'bg-white text-gray-800 placeholder-gray-400'\n            }`}\n            rows={1}\n            style={{ minHeight: '44px', maxHeight: '200px' }}\n          />\n          \n          {/* 底部操作栏 */}\n          <div className={`flex justify-between items-center px-3 py-2 ${\n            isDarkMode \n              ? 'bg-gray-800 border-t border-gray-700' \n              : 'bg-gray-50 border-t border-gray-200'\n          }`}>\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"text-xs text-gray-500\">按 Enter 发送，Shift+Enter 换行</div>\n              \n              {/* 添加@引用按钮 */}\n              <button\n                onClick={() => setShowReferenceSelector(!showReferenceSelector)}\n                className={`text-xs flex items-center ${\n                  isDarkMode \n                    ? 'text-gray-400 hover:text-gray-300' \n                    : 'text-gray-600 hover:text-gray-700'\n                }`}\n              >\n                <svg className=\"w-3.5 h-3.5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                </svg>\n                <span>引用文件</span>\n              </button>\n            </div>\n            \n            <Button \n              onClick={handleSendMessage}\n              disabled={!inputValue.trim() || status !== 'idle'}\n              className={`h-7 px-3 text-sm font-medium ${\n                !inputValue.trim() || status !== 'idle'\n                  ? 'opacity-50 cursor-not-allowed'\n                  : ''\n              } ${\n                isDarkMode \n                  ? 'bg-blue-600 hover:bg-blue-700 text-white' \n                  : 'bg-blue-600 hover:bg-blue-700 text-white'\n              }`}\n            >\n              发送\n            </Button>\n          </div>\n        </div>\n        \n        {/* 文件引用选择器 - Cursor风格 */}\n        {showReferenceSelector && (\n          <div className={`mt-1 rounded-md border ${\n            isDarkMode \n              ? 'border-gray-700 bg-gray-800' \n              : 'border-gray-300 bg-white'\n          } max-h-48 overflow-y-auto shadow-lg`}>\n            <div className=\"p-2\">\n              <div className=\"text-xs font-medium mb-2 px-2\">选择要引用的文件：</div>\n              <div>\n                {availableFiles.map(file => (\n                  <div \n                    key={file}\n                    className={`px-3 py-1.5 text-xs rounded cursor-pointer ${\n                      isDarkMode \n                        ? 'hover:bg-gray-700' \n                        : 'hover:bg-gray-100'\n                    }`}\n                    onClick={() => handleReferenceSelect(file)}\n                  >\n                    <div className=\"flex items-center\">\n                      <svg className=\"w-3.5 h-3.5 mr-2 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                      {file}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n        \n        {status === 'error' && (\n          <div className=\"text-xs text-red-500 mt-1 ml-2\">发送失败，请重试</div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AIChat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}