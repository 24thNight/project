{"ast":null,"code":"var _jsxFileName = \"/home/devbox/project/src/pages/workspace-page.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport AIChat from '../components/features/ai-chat/ai-chat';\nimport CommandPalette from '../components/features/command/command-palette';\nimport FileExplorer from '../components/features/workspace/file-explorer';\nimport FileEditor from '../components/features/workspace/file-editor';\nimport ResizablePanel from '../components/features/workspace/resizable-panel';\nimport Navbar from '../components/layouts/navbar';\nimport { toast } from 'sonner';\nimport { useLanguage } from '../lib/language-context';\nimport { useCommandPalette } from '../lib/hooks/use-command-palette';\nimport { usePlanStore } from '../lib/store';\n\n// 文件内容类型定义\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n/**\n * 工作空间页面\n * \n * 集成式AI工作环境，可与AI助手交互，管理任务和文件\n */\nconst WorkspacePage = () => {\n  _s();\n  const {\n    t,\n    language\n  } = useLanguage();\n  const [searchParams] = useSearchParams();\n  const planId = searchParams.get('planId');\n  const {\n    getPlanById\n  } = usePlanStore();\n\n  // 所有状态定义放在最前面\n  const [planTitle, setPlanTitle] = useState(null);\n  const [isLeftSidebarCollapsed, setIsLeftSidebarCollapsed] = useState(false);\n  const [isRightSidebarCollapsed, setIsRightSidebarCollapsed] = useState(false);\n\n  // 文件状态\n  const [openFiles, setOpenFiles] = useState(['workspace.txt']);\n  const [currentFile, setCurrentFile] = useState('workspace.txt');\n  const [fileContents, setFileContents] = useState({\n    'workspace.txt': `# 任务计划 AI 工作区\n\n这是一个集成式AI工作环境，你可以：\n- 向AI提出关于任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`,\n    'project.json': `{\n  \"name\": \"任务计划\",\n  \"version\": \"1.0.0\",\n  \"description\": \"现代化的任务管理应用\",\n  \"framework\": \"React\",\n  \"components\": {\n    \"plans\": \"src/components/features/plan-tree/plan-tree.tsx\",\n    \"workspace\": \"src/pages/workspace-page.tsx\",\n    \"dashboard\": \"src/pages/dashboard-page.tsx\"\n  }\n}`\n  });\n\n  // 加载任务信息 - 移到状态定义之后\n  useEffect(() => {\n    if (planId) {\n      const plan = getPlanById(planId);\n      if (plan) {\n        // 设置计划标题，用于左侧栏显示\n        console.log('加载任务信息:', plan.title);\n        setPlanTitle(plan.title);\n\n        // 创建任务特定的工作区文件\n        const taskWorkspaceContent = `# ${plan.title} - AI 工作区\n\n这是与\"${plan.title}\"任务相关的工作区，你可以：\n- 向AI提出关于此任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`;\n\n        // 更新文件内容\n        setFileContents(prev => ({\n          ...prev,\n          'workspace.txt': taskWorkspaceContent\n        }));\n      } else {\n        console.log('找不到指定ID的任务:', planId);\n      }\n    } else {\n      console.log('没有提供任务ID');\n    }\n  }, [planId, getPlanById]);\n\n  // 监听planTitle的变化\n  useEffect(() => {\n    console.log('planTitle更新为:', planTitle);\n  }, [planTitle]);\n\n  // 定义命令\n  const workspaceCommands = [{\n    id: 'new-file',\n    name: language === 'zh' ? '新建文件' : 'New File',\n    description: language === 'zh' ? '创建一个新的文件' : 'Create a new file',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M12 4v16m8-8H4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      const fileName = prompt(language === 'zh' ? '请输入文件名:' : 'Enter file name:');\n      if (fileName && !openFiles.includes(fileName)) {\n        setOpenFiles(prev => [...prev, fileName]);\n        setFileContents(prev => ({\n          ...prev,\n          [fileName]: ''\n        }));\n        setCurrentFile(fileName);\n        toast.success(language === 'zh' ? `文件 ${fileName} 已创建` : `File ${fileName} created`);\n      }\n    }\n  }, {\n    id: 'toggle-left-sidebar',\n    name: language === 'zh' ? '切换左侧栏' : 'Toggle Left Sidebar',\n    description: language === 'zh' ? '显示或隐藏左侧文件栏' : 'Show or hide the file explorer',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M4 6h16M4 12h16M4 18h7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed);\n    }\n  }, {\n    id: 'toggle-right-sidebar',\n    name: language === 'zh' ? '切换AI助手' : 'Toggle AI Assistant',\n    description: language === 'zh' ? '显示或隐藏右侧AI助手' : 'Show or hide the AI assistant panel',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsRightSidebarCollapsed(!isRightSidebarCollapsed);\n    }\n  }, {\n    id: 'ask-ai',\n    name: language === 'zh' ? '询问AI' : 'Ask AI',\n    description: language === 'zh' ? '直接向AI助手提问' : 'Ask a question to the AI assistant',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsRightSidebarCollapsed(false);\n      toast.info(language === 'zh' ? '请在AI助手栏中提问' : 'Please ask in the AI assistant panel');\n    }\n  }];\n\n  // 使用命令面板钩子\n  const {\n    isOpen,\n    setIsOpen,\n    commands,\n    executeCommand\n  } = useCommandPalette(workspaceCommands);\n\n  // 文件操作处理函数\n  const handleFileClick = fileName => {\n    setCurrentFile(fileName);\n  };\n  const handleCreateFile = fileName => {\n    if (!openFiles.includes(fileName)) {\n      setOpenFiles(prev => [...prev, fileName]);\n      setFileContents(prev => ({\n        ...prev,\n        [fileName]: ''\n      }));\n      setCurrentFile(fileName);\n    }\n  };\n  const handleContentChange = (fileName, content) => {\n    setFileContents(prev => ({\n      ...prev,\n      [fileName]: content\n    }));\n  };\n\n  // 处理AI消息\n  const handleSendMessage = async (message, references) => {\n    // 模拟AI响应\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let response = '';\n\n        // 根据消息内容模拟不同的响应\n        if (message.toLowerCase().includes('任务拆解')) {\n          response = `我可以帮你拆解任务。一个好的任务拆解应该包含以下几个步骤：\n\n1. 明确任务目标\n2. 将大任务分解为小任务\n3. 评估每个小任务的优先级\n4. 设定每个小任务的完成时间\n5. 分配资源\n\n希望这对你有所帮助！`;\n        } else if (message.toLowerCase().includes('优化')) {\n          response = `要优化你的任务计划，可以考虑以下几点：\n\n1. 使用番茄工作法提高专注度\n2. 建立例行公事，减少决策疲劳\n3. 批量处理同类型的任务\n4. 定期回顾和调整你的计划\n5. 使用自动化工具减少重复工作`;\n        } else if (references && references.length > 0) {\n          // 如果有引用文件，基于文件内容给出响应\n          const fileContent = references.map(file => fileContents[file] || `(无法读取文件 ${file})`).join('\\n\\n');\n          response = `我已分析了你引用的文件。以下是我的发现：\n\n根据文件内容，这是一个使用React框架构建的任务管理应用。主要组件包括计划树(plan-tree)、工作区和仪表盘。\n\n我建议你可以：\n1. 检查组件之间的数据流是否清晰\n2. 确保状态管理逻辑集中且一致\n3. 考虑添加单元测试确保功能稳定性`;\n        } else {\n          response = `我是你的AI助手，可以帮助你:\n\n- 回答关于任务管理的问题\n- 提供任务拆解和优化建议\n- 分析项目文件和代码\n\n你可以尝试询问关于\"任务拆解\"或\"优化\"的问题，或者使用@引用特定文件，我会基于文件内容给你更具体的建议。`;\n        }\n        resolve(response);\n      }, 1500);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen flex flex-col bg-gray-50\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {\n      onOpenCommandPalette: () => setIsOpen(true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex overflow-hidden relative\",\n      children: [/*#__PURE__*/_jsxDEV(ResizablePanel, {\n        initialWidth: 256,\n        position: \"left\",\n        isCollapsed: isLeftSidebarCollapsed,\n        onToggleCollapse: () => setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed),\n        children: /*#__PURE__*/_jsxDEV(FileExplorer, {\n          openFiles: openFiles,\n          currentFile: currentFile,\n          fileContents: fileContents,\n          onFileClick: handleFileClick,\n          onCreateFile: handleCreateFile,\n          planTitle: planTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-1 overflow-hidden\",\n        children: /*#__PURE__*/_jsxDEV(FileEditor, {\n          currentFile: currentFile,\n          fileContents: fileContents,\n          onContentChange: handleContentChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ResizablePanel, {\n        initialWidth: 384,\n        position: \"right\",\n        isCollapsed: isRightSidebarCollapsed,\n        onToggleCollapse: () => setIsRightSidebarCollapsed(!isRightSidebarCollapsed),\n        children: /*#__PURE__*/_jsxDEV(AIChat, {\n          onSendMessage: handleSendMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }, this), isOpen && /*#__PURE__*/_jsxDEV(CommandPalette, {\n      isOpen: isOpen,\n      setIsOpen: setIsOpen,\n      commands: commands,\n      onSelect: executeCommand\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 250,\n    columnNumber: 5\n  }, this);\n};\n_s(WorkspacePage, \"HwG+Whm7SxGyOCzYjq3RYdYEV6Q=\", false, function () {\n  return [useLanguage, useSearchParams, usePlanStore, useCommandPalette];\n});\n_c = WorkspacePage;\nexport default WorkspacePage;\nvar _c;\n$RefreshReg$(_c, \"WorkspacePage\");","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","AIChat","CommandPalette","FileExplorer","FileEditor","ResizablePanel","Navbar","toast","useLanguage","useCommandPalette","usePlanStore","jsxDEV","_jsxDEV","WorkspacePage","_s","t","language","searchParams","planId","get","getPlanById","planTitle","setPlanTitle","isLeftSidebarCollapsed","setIsLeftSidebarCollapsed","isRightSidebarCollapsed","setIsRightSidebarCollapsed","openFiles","setOpenFiles","currentFile","setCurrentFile","fileContents","setFileContents","plan","console","log","title","taskWorkspaceContent","prev","workspaceCommands","id","name","description","icon","className","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","action","prompt","includes","success","info","isOpen","setIsOpen","commands","executeCommand","handleFileClick","handleCreateFile","handleContentChange","content","handleSendMessage","message","references","Promise","resolve","setTimeout","response","toLowerCase","length","fileContent","map","file","join","onOpenCommandPalette","initialWidth","position","isCollapsed","onToggleCollapse","onFileClick","onCreateFile","onContentChange","onSendMessage","onSelect","_c","$RefreshReg$"],"sources":["/home/devbox/project/src/pages/workspace-page.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport AIChat from '../components/features/ai-chat/ai-chat';\nimport CommandPalette from '../components/features/command/command-palette';\nimport FileExplorer from '../components/features/workspace/file-explorer';\nimport FileEditor from '../components/features/workspace/file-editor';\nimport ResizablePanel from '../components/features/workspace/resizable-panel';\nimport Navbar from '../components/layouts/navbar';\nimport { toast } from 'sonner';\nimport { useLanguage } from '../lib/language-context';\nimport { Command, useCommandPalette } from '../lib/hooks/use-command-palette';\nimport { usePlanStore } from '../lib/store';\n\n// 文件内容类型定义\ninterface FileContents {\n  [key: string]: string;\n}\n\n/**\n * 工作空间页面\n * \n * 集成式AI工作环境，可与AI助手交互，管理任务和文件\n */\nconst WorkspacePage: React.FC = () => {\n  const { t, language } = useLanguage();\n  const [searchParams] = useSearchParams();\n  const planId = searchParams.get('planId');\n  const { getPlanById } = usePlanStore();\n  \n  // 所有状态定义放在最前面\n  const [planTitle, setPlanTitle] = useState<string | null>(null);\n  const [isLeftSidebarCollapsed, setIsLeftSidebarCollapsed] = useState(false);\n  const [isRightSidebarCollapsed, setIsRightSidebarCollapsed] = useState(false);\n  \n  // 文件状态\n  const [openFiles, setOpenFiles] = useState(['workspace.txt']);\n  const [currentFile, setCurrentFile] = useState('workspace.txt');\n  const [fileContents, setFileContents] = useState<FileContents>({\n    'workspace.txt': `# 任务计划 AI 工作区\n\n这是一个集成式AI工作环境，你可以：\n- 向AI提出关于任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`,\n    'project.json': `{\n  \"name\": \"任务计划\",\n  \"version\": \"1.0.0\",\n  \"description\": \"现代化的任务管理应用\",\n  \"framework\": \"React\",\n  \"components\": {\n    \"plans\": \"src/components/features/plan-tree/plan-tree.tsx\",\n    \"workspace\": \"src/pages/workspace-page.tsx\",\n    \"dashboard\": \"src/pages/dashboard-page.tsx\"\n  }\n}`\n  });\n  \n  // 加载任务信息 - 移到状态定义之后\n  useEffect(() => {\n    if (planId) {\n      const plan = getPlanById(planId);\n      if (plan) {\n        // 设置计划标题，用于左侧栏显示\n        console.log('加载任务信息:', plan.title);\n        setPlanTitle(plan.title);\n        \n        // 创建任务特定的工作区文件\n        const taskWorkspaceContent = `# ${plan.title} - AI 工作区\n\n这是与\"${plan.title}\"任务相关的工作区，你可以：\n- 向AI提出关于此任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`;\n\n        // 更新文件内容\n        setFileContents(prev => ({\n          ...prev,\n          'workspace.txt': taskWorkspaceContent\n        }));\n      } else {\n        console.log('找不到指定ID的任务:', planId);\n      }\n    } else {\n      console.log('没有提供任务ID');\n    }\n  }, [planId, getPlanById]);\n  \n  // 监听planTitle的变化\n  useEffect(() => {\n    console.log('planTitle更新为:', planTitle);\n  }, [planTitle]);\n  \n  // 定义命令\n  const workspaceCommands: Command[] = [\n    {\n      id: 'new-file',\n      name: language === 'zh' ? '新建文件' : 'New File',\n      description: language === 'zh' ? '创建一个新的文件' : 'Create a new file',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n        </svg>\n      ),\n      action: () => {\n        const fileName = prompt(language === 'zh' ? '请输入文件名:' : 'Enter file name:');\n        if (fileName && !openFiles.includes(fileName)) {\n          setOpenFiles(prev => [...prev, fileName]);\n          setFileContents(prev => ({\n            ...prev,\n            [fileName]: ''\n          }));\n          setCurrentFile(fileName);\n          toast.success(language === 'zh' ? `文件 ${fileName} 已创建` : `File ${fileName} created`);\n        }\n      }\n    },\n    {\n      id: 'toggle-left-sidebar',\n      name: language === 'zh' ? '切换左侧栏' : 'Toggle Left Sidebar',\n      description: language === 'zh' ? '显示或隐藏左侧文件栏' : 'Show or hide the file explorer',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h7\" />\n        </svg>\n      ),\n      action: () => {\n        setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed);\n      }\n    },\n    {\n      id: 'toggle-right-sidebar',\n      name: language === 'zh' ? '切换AI助手' : 'Toggle AI Assistant',\n      description: language === 'zh' ? '显示或隐藏右侧AI助手' : 'Show or hide the AI assistant panel',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n        </svg>\n      ),\n      action: () => {\n        setIsRightSidebarCollapsed(!isRightSidebarCollapsed);\n      }\n    },\n    {\n      id: 'ask-ai',\n      name: language === 'zh' ? '询问AI' : 'Ask AI',\n      description: language === 'zh' ? '直接向AI助手提问' : 'Ask a question to the AI assistant',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n        </svg>\n      ),\n      action: () => {\n        setIsRightSidebarCollapsed(false);\n        toast.info(language === 'zh' ? '请在AI助手栏中提问' : 'Please ask in the AI assistant panel');\n      }\n    }\n  ];\n  \n  // 使用命令面板钩子\n  const { isOpen, setIsOpen, commands, executeCommand } = useCommandPalette(workspaceCommands);\n  \n  // 文件操作处理函数\n  const handleFileClick = (fileName: string) => {\n    setCurrentFile(fileName);\n  };\n  \n  const handleCreateFile = (fileName: string) => {\n    if (!openFiles.includes(fileName)) {\n      setOpenFiles(prev => [...prev, fileName]);\n      setFileContents(prev => ({\n        ...prev,\n        [fileName]: ''\n      }));\n      setCurrentFile(fileName);\n    }\n  };\n  \n  const handleContentChange = (fileName: string, content: string) => {\n    setFileContents(prev => ({\n      ...prev,\n      [fileName]: content\n    }));\n  };\n\n  // 处理AI消息\n  const handleSendMessage = async (message: string, references?: string[]): Promise<string> => {\n    // 模拟AI响应\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        let response = '';\n        \n        // 根据消息内容模拟不同的响应\n        if (message.toLowerCase().includes('任务拆解')) {\n          response = `我可以帮你拆解任务。一个好的任务拆解应该包含以下几个步骤：\n\n1. 明确任务目标\n2. 将大任务分解为小任务\n3. 评估每个小任务的优先级\n4. 设定每个小任务的完成时间\n5. 分配资源\n\n希望这对你有所帮助！`;\n        } else if (message.toLowerCase().includes('优化')) {\n          response = `要优化你的任务计划，可以考虑以下几点：\n\n1. 使用番茄工作法提高专注度\n2. 建立例行公事，减少决策疲劳\n3. 批量处理同类型的任务\n4. 定期回顾和调整你的计划\n5. 使用自动化工具减少重复工作`;\n        } else if (references && references.length > 0) {\n          // 如果有引用文件，基于文件内容给出响应\n          const fileContent = references.map(file => fileContents[file] || `(无法读取文件 ${file})`).join('\\n\\n');\n          response = `我已分析了你引用的文件。以下是我的发现：\n\n根据文件内容，这是一个使用React框架构建的任务管理应用。主要组件包括计划树(plan-tree)、工作区和仪表盘。\n\n我建议你可以：\n1. 检查组件之间的数据流是否清晰\n2. 确保状态管理逻辑集中且一致\n3. 考虑添加单元测试确保功能稳定性`;\n        } else {\n          response = `我是你的AI助手，可以帮助你:\n\n- 回答关于任务管理的问题\n- 提供任务拆解和优化建议\n- 分析项目文件和代码\n\n你可以尝试询问关于\"任务拆解\"或\"优化\"的问题，或者使用@引用特定文件，我会基于文件内容给你更具体的建议。`;\n        }\n        \n        resolve(response);\n      }, 1500);\n    });\n  };\n  \n  return (\n    <div className=\"h-screen flex flex-col bg-gray-50\">\n      {/* 顶部导航栏 */}\n      <Navbar onOpenCommandPalette={() => setIsOpen(true)} />\n      \n      {/* 主体内容 */}\n      <div className=\"flex-1 flex overflow-hidden relative\">\n        {/* 左侧文件浏览器 */}\n        <ResizablePanel\n          initialWidth={256}\n          position=\"left\"\n          isCollapsed={isLeftSidebarCollapsed}\n          onToggleCollapse={() => setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed)}\n        >\n          <FileExplorer\n            openFiles={openFiles}\n            currentFile={currentFile}\n            fileContents={fileContents}\n            onFileClick={handleFileClick}\n            onCreateFile={handleCreateFile}\n            planTitle={planTitle}\n          />\n        </ResizablePanel>\n        \n        {/* 中间编辑器区域 */}\n        <main className=\"flex-1 overflow-hidden\">\n          <FileEditor\n            currentFile={currentFile}\n            fileContents={fileContents}\n            onContentChange={handleContentChange}\n          />\n        </main>\n        \n        {/* 右侧AI助手 */}\n        <ResizablePanel\n          initialWidth={384}\n          position=\"right\"\n          isCollapsed={isRightSidebarCollapsed}\n          onToggleCollapse={() => setIsRightSidebarCollapsed(!isRightSidebarCollapsed)}\n        >\n          <AIChat onSendMessage={handleSendMessage} />\n        </ResizablePanel>\n      </div>\n      \n      {/* 命令面板 */}\n      {isOpen && (\n        <CommandPalette\n          isOpen={isOpen}\n          setIsOpen={setIsOpen}\n          commands={commands}\n          onSelect={executeCommand}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default WorkspacePage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}