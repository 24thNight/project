{"ast":null,"code":"// 预设的中英文问题对\n\n// 更丰富的问题集合\nconst mockQuestionPairs = [{\n  en: \"What is your main motivation for achieving this goal?\",\n  zh: \"请描述一下你想实现这个目标的主要原因是什么？\"\n}, {\n  en: \"In what timeframe would you like to complete this goal?\",\n  zh: \"你希望在什么时间范围内完成这个目标？\"\n}, {\n  en: \"What do you think will be the biggest obstacle to achieving this goal?\",\n  zh: \"你认为实现这个目标的最大障碍是什么？\"\n}, {\n  en: \"What steps have you already taken towards this goal?\",\n  zh: \"你已经采取了哪些步骤来实现这个目标？\"\n}, {\n  en: \"What resources or skills do you need to help you achieve this goal?\",\n  zh: \"你需要什么资源或技能来帮助你实现这个目标？\"\n}, {\n  en: \"How will you measure success for this goal?\",\n  zh: \"你将如何衡量这个目标的成功？\"\n}, {\n  en: \"Who can support you in achieving this goal?\",\n  zh: \"谁能在你实现这个目标的过程中给予你支持？\"\n}, {\n  en: \"What will be your first step towards this goal?\",\n  zh: \"你朝着这个目标迈出的第一步会是什么？\"\n}, {\n  en: \"How much time can you dedicate to this goal each week?\",\n  zh: \"你每周能够为这个目标投入多少时间？\"\n}, {\n  en: \"What potential benefits do you expect to gain from achieving this goal?\",\n  zh: \"实现这个目标后，你期望获得哪些潜在好处？\"\n}];\n\n// 根据语言选择问题列表\nconst getMockQuestions = (lang = 'en') => {\n  return mockQuestionPairs.map(q => q[lang]);\n};\n\n// 生成唯一ID\nconst generateId = () => `id-${Date.now()}-${Math.floor(Math.random() * 1000)}`;\n\n// 模拟延迟\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\nexport const mockClarificationApi = {\n  // 开始一个新的会话\n  startSession: async planId => {\n    // 模拟网络延迟\n    await delay(800);\n    return `session-${Date.now()}`;\n  },\n  // 提交答案\n  submitAnswer: async (sessionId, answer) => {\n    // 模拟网络延迟\n    await delay(500);\n    return true;\n  },\n  // 完成会话并生成计划\n  completeSession: async sessionId => {\n    // 模拟网络延迟\n    await delay(1200);\n    return `plan-${Date.now()}`;\n  },\n  // 创建模拟问题流\n  createQuestionStream: (sessionId, onEvent, onError, lang = 'en') => {\n    // 获取对应语言的问题列表\n    const questions = getMockQuestions(lang);\n    let questionIndex = 0;\n    let isClosed = false;\n\n    // 模拟流式发送问题的函数\n    const streamQuestion = async index => {\n      if (isClosed || index >= questions.length) return;\n      const question = questions[index];\n      const questionId = generateId();\n\n      // 模拟流式传输单词\n      const words = question.split(' ');\n\n      // 先发送空字符，触发UI显示\n      onEvent({\n        type: 'question',\n        data: ''\n      });\n\n      // 逐个单词发送，模拟流式效果\n      for (let i = 0; i < words.length; i++) {\n        if (isClosed) return;\n\n        // 中文使用较短的延迟，因为字符较少\n        await delay(lang === 'zh' ? 200 : 250);\n        onEvent({\n          type: 'question',\n          data: (i === 0 ? '' : ' ') + words[i]\n        });\n      }\n\n      // 发送问题完成事件\n      await delay(300);\n      if (!isClosed) {\n        onEvent({\n          type: 'completion',\n          data: 'question completed',\n          id: questionId,\n          questionType: 'open',\n          required: true\n        });\n      }\n\n      // 在收到回答后发送下一个问题\n      // 实际会在submitAnswer调用后发送下一个问题，但这里我们模拟等待用户输入的时间间隔\n      if (index < questions.length - 1) {\n        await delay(1000); // 等待时间，模拟服务器处理\n        streamQuestion(index + 1);\n      }\n    };\n\n    // 开始发送第一个问题\n    setTimeout(() => {\n      streamQuestion(questionIndex);\n    }, 1000);\n\n    // 返回关闭连接的方法\n    return {\n      close: () => {\n        isClosed = true;\n        console.log('Mock SSE connection closed');\n      }\n    };\n  }\n};","map":{"version":3,"names":["mockQuestionPairs","en","zh","getMockQuestions","lang","map","q","generateId","Date","now","Math","floor","random","delay","ms","Promise","resolve","setTimeout","mockClarificationApi","startSession","planId","submitAnswer","sessionId","answer","completeSession","createQuestionStream","onEvent","onError","questions","questionIndex","isClosed","streamQuestion","index","length","question","questionId","words","split","type","data","i","id","questionType","required","close","console","log"],"sources":["/home/devbox/project/src/features/clarification/utils/mock-api.ts"],"sourcesContent":["import { Answer, StreamEvent } from '../types';\nimport { Language } from '../../../lib/i18n';\n\n// 预设的中英文问题对\ninterface MockQuestion {\n  en: string;\n  zh: string;\n}\n\n// 更丰富的问题集合\nconst mockQuestionPairs: MockQuestion[] = [\n  {\n    en: \"What is your main motivation for achieving this goal?\",\n    zh: \"请描述一下你想实现这个目标的主要原因是什么？\"\n  },\n  {\n    en: \"In what timeframe would you like to complete this goal?\",\n    zh: \"你希望在什么时间范围内完成这个目标？\"\n  },\n  {\n    en: \"What do you think will be the biggest obstacle to achieving this goal?\",\n    zh: \"你认为实现这个目标的最大障碍是什么？\"\n  },\n  {\n    en: \"What steps have you already taken towards this goal?\",\n    zh: \"你已经采取了哪些步骤来实现这个目标？\"\n  },\n  {\n    en: \"What resources or skills do you need to help you achieve this goal?\",\n    zh: \"你需要什么资源或技能来帮助你实现这个目标？\"\n  },\n  {\n    en: \"How will you measure success for this goal?\",\n    zh: \"你将如何衡量这个目标的成功？\"\n  },\n  {\n    en: \"Who can support you in achieving this goal?\",\n    zh: \"谁能在你实现这个目标的过程中给予你支持？\"\n  },\n  {\n    en: \"What will be your first step towards this goal?\",\n    zh: \"你朝着这个目标迈出的第一步会是什么？\"\n  },\n  {\n    en: \"How much time can you dedicate to this goal each week?\",\n    zh: \"你每周能够为这个目标投入多少时间？\"\n  },\n  {\n    en: \"What potential benefits do you expect to gain from achieving this goal?\",\n    zh: \"实现这个目标后，你期望获得哪些潜在好处？\"\n  }\n];\n\n// 根据语言选择问题列表\nconst getMockQuestions = (lang: Language = 'en'): string[] => {\n  return mockQuestionPairs.map(q => q[lang]);\n};\n\n// 生成唯一ID\nconst generateId = () => `id-${Date.now()}-${Math.floor(Math.random() * 1000)}`;\n\n// 模拟延迟\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport const mockClarificationApi = {\n  // 开始一个新的会话\n  startSession: async (planId?: string) => {\n    // 模拟网络延迟\n    await delay(800);\n    return `session-${Date.now()}`;\n  },\n  \n  // 提交答案\n  submitAnswer: async (sessionId: string, answer: Answer) => {\n    // 模拟网络延迟\n    await delay(500);\n    return true;\n  },\n  \n  // 完成会话并生成计划\n  completeSession: async (sessionId: string) => {\n    // 模拟网络延迟\n    await delay(1200);\n    return `plan-${Date.now()}`;\n  },\n  \n  // 创建模拟问题流\n  createQuestionStream: (\n    sessionId: string,\n    onEvent: (event: StreamEvent) => void,\n    onError: (error: string) => void,\n    lang: Language = 'en'\n  ) => {\n    // 获取对应语言的问题列表\n    const questions = getMockQuestions(lang);\n    let questionIndex = 0;\n    let isClosed = false;\n    \n    // 模拟流式发送问题的函数\n    const streamQuestion = async (index: number) => {\n      if (isClosed || index >= questions.length) return;\n      \n      const question = questions[index];\n      const questionId = generateId();\n      \n      // 模拟流式传输单词\n      const words = question.split(' ');\n      \n      // 先发送空字符，触发UI显示\n      onEvent({\n        type: 'question',\n        data: '',\n      });\n      \n      // 逐个单词发送，模拟流式效果\n      for (let i = 0; i < words.length; i++) {\n        if (isClosed) return;\n        \n        // 中文使用较短的延迟，因为字符较少\n        await delay(lang === 'zh' ? 200 : 250);\n        \n        onEvent({\n          type: 'question',\n          data: (i === 0 ? '' : ' ') + words[i],\n        });\n      }\n      \n      // 发送问题完成事件\n      await delay(300);\n      \n      if (!isClosed) {\n        onEvent({\n          type: 'completion',\n          data: 'question completed',\n          id: questionId,\n          questionType: 'open',\n          required: true\n        });\n      }\n      \n      // 在收到回答后发送下一个问题\n      // 实际会在submitAnswer调用后发送下一个问题，但这里我们模拟等待用户输入的时间间隔\n      if (index < questions.length - 1) {\n        await delay(1000); // 等待时间，模拟服务器处理\n        streamQuestion(index + 1);\n      }\n    };\n    \n    // 开始发送第一个问题\n    setTimeout(() => {\n      streamQuestion(questionIndex);\n    }, 1000);\n    \n    // 返回关闭连接的方法\n    return {\n      close: () => {\n        isClosed = true;\n        console.log('Mock SSE connection closed');\n      }\n    };\n  }\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}