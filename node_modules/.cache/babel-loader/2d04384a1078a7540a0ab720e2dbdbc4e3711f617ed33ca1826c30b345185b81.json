{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useLanguage}from'../../../lib/language-context';import{Button}from'../../../components/ui/button';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// 日志辅助函数\nconst devLog=function(message){if(process.env.NODE_ENV!=='production'){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}console.log(message,...args);}};const NewPlanDialog=_ref=>{let{isOpen,onClose}=_ref;const{t,language}=useLanguage();const navigate=useNavigate();const[userInput,setUserInput]=useState('');useEffect(()=>{if(isOpen){// Reset input when dialog opens\nsetUserInput('');// Focus the textarea when dialog opens\nconst timer=setTimeout(()=>{const textArea=document.getElementById('plan-goal-input');if(textArea){textArea.focus();}},100);return()=>clearTimeout(timer);}},[isOpen]);if(!isOpen)return null;const handleCancel=()=>{onClose();};const handleNext=()=>{if(!userInput.trim())return;devLog(`[Dialog] Preparing to navigate to clarification page with goal: ${userInput.trim()}`);// 获取当前URL中的查询参数，如果有的话保留\nconst searchParams=new URLSearchParams(window.location.search);// 在开发环境下添加 useMock=true 参数\nif(process.env.NODE_ENV!=='production'){// 只有在没有明确设置为false的情况下才设置为true\nif(searchParams.get('useMock')!=='false'){searchParams.set('useMock','true');}}// 准备搜索参数字符串\nconst searchString=searchParams.toString();const queryString=searchString?`?${searchString}`:'';// Navigate to the clarification page with the goal title as state\nnavigate(`/clarify-new${queryString}`,{state:{goalTitle:userInput.trim(),lang:language}});// Close the dialog\nonClose();};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-xl w-full max-w-lg m-4 overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-5 border-b border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-800\",children:t('dashboard.newPlanDialog.title')}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,className:\"rounded-full p-2 hover:bg-gray-100 transition-colors\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M18 6L6 18\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M6 6L18 18\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"plan-goal-input\",className:\"block text-sm font-medium text-gray-700 mb-2\",children:t('dashboard.newPlanDialog.inputLabel')}),/*#__PURE__*/_jsx(\"textarea\",{id:\"plan-goal-input\",value:userInput,onChange:e=>setUserInput(e.target.value),placeholder:t('dashboard.newPlanDialog.placeholder'),className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all min-h-[120px] text-base\",maxLength:200,autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 text-xs text-gray-500 text-right\",children:[userInput.length,\"/200\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end items-center px-5 py-4 bg-gray-50 border-t border-gray-100\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",className:\"mr-2\",onClick:handleCancel,children:t('dashboard.cancel')}),/*#__PURE__*/_jsx(Button,{type:\"button\",disabled:!userInput.trim(),className:\"px-6 bg-indigo-600 hover:bg-indigo-700 rounded-full\",onClick:handleNext,children:t('dashboard.newPlanDialog.next')})]})]})});};export default NewPlanDialog;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useLanguage","Button","jsx","_jsx","jsxs","_jsxs","devLog","message","process","env","NODE_ENV","_len","arguments","length","args","Array","_key","console","log","NewPlanDialog","_ref","isOpen","onClose","t","language","navigate","userInput","setUserInput","timer","setTimeout","textArea","document","getElementById","focus","clearTimeout","handleCancel","handleNext","trim","searchParams","URLSearchParams","window","location","search","get","set","searchString","toString","queryString","state","goalTitle","lang","className","children","onClick","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","htmlFor","id","value","onChange","e","target","placeholder","maxLength","autoFocus","variant","type","disabled"],"sources":["/home/devbox/project/src/components/features/dashboard/new-plan-dialog.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useLanguage } from '../../../lib/language-context';\nimport { Button } from '../../../components/ui/button';\nimport { toast } from 'sonner';\n\n// 日志辅助函数\nconst devLog = (message: string, ...args: any[]) => {\n  if (process.env.NODE_ENV !== 'production') {\n    console.log(message, ...args);\n  }\n};\n\ninterface NewPlanDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst NewPlanDialog: React.FC<NewPlanDialogProps> = ({ isOpen, onClose }) => {\n  const { t, language } = useLanguage();\n  const navigate = useNavigate();\n  const [userInput, setUserInput] = useState('');\n  \n  useEffect(() => {\n    if (isOpen) {\n      // Reset input when dialog opens\n      setUserInput('');\n      \n      // Focus the textarea when dialog opens\n      const timer = setTimeout(() => {\n        const textArea = document.getElementById('plan-goal-input');\n        if (textArea) {\n          textArea.focus();\n        }\n      }, 100);\n      \n      return () => clearTimeout(timer);\n    }\n  }, [isOpen]);\n  \n  if (!isOpen) return null;\n  \n  const handleCancel = () => {\n    onClose();\n  };\n  \n  const handleNext = () => {\n    if (!userInput.trim()) return;\n    \n    devLog(`[Dialog] Preparing to navigate to clarification page with goal: ${userInput.trim()}`);\n    \n    // 获取当前URL中的查询参数，如果有的话保留\n    const searchParams = new URLSearchParams(window.location.search);\n    \n    // 在开发环境下添加 useMock=true 参数\n    if (process.env.NODE_ENV !== 'production') {\n      // 只有在没有明确设置为false的情况下才设置为true\n      if (searchParams.get('useMock') !== 'false') {\n        searchParams.set('useMock', 'true');\n      }\n    }\n    \n    // 准备搜索参数字符串\n    const searchString = searchParams.toString();\n    const queryString = searchString ? `?${searchString}` : '';\n    \n    // Navigate to the clarification page with the goal title as state\n    navigate(`/clarify-new${queryString}`, {\n      state: {\n        goalTitle: userInput.trim(),\n        lang: language\n      }\n    });\n    \n    // Close the dialog\n    onClose();\n  };\n  \n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-xl shadow-xl w-full max-w-lg m-4 overflow-hidden\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-5 border-b border-gray-100\">\n          <h2 className=\"text-xl font-semibold text-gray-800\">\n            {t('dashboard.newPlanDialog.title')}\n          </h2>\n          <button \n            onClick={handleCancel}\n            className=\"rounded-full p-2 hover:bg-gray-100 transition-colors\"\n            aria-label=\"Close\"\n          >\n            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M18 6L6 18\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              <path d=\"M6 6L18 18\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n            </svg>\n          </button>\n        </div>\n        \n        {/* Body */}\n        <div className=\"p-5\">\n          <label \n            htmlFor=\"plan-goal-input\" \n            className=\"block text-sm font-medium text-gray-700 mb-2\"\n          >\n            {t('dashboard.newPlanDialog.inputLabel')}\n          </label>\n          <textarea\n            id=\"plan-goal-input\"\n            value={userInput}\n            onChange={(e) => setUserInput(e.target.value)}\n            placeholder={t('dashboard.newPlanDialog.placeholder')}\n            className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all min-h-[120px] text-base\"\n            maxLength={200}\n            autoFocus\n          />\n          <div className=\"mt-1 text-xs text-gray-500 text-right\">\n            {userInput.length}/200\n          </div>\n        </div>\n        \n        {/* Footer */}\n        <div className=\"flex justify-end items-center px-5 py-4 bg-gray-50 border-t border-gray-100\">\n          <Button \n            variant=\"outline\"\n            className=\"mr-2\"\n            onClick={handleCancel}\n          >\n            {t('dashboard.cancel')}\n          </Button>\n          <Button \n            type=\"button\"\n            disabled={!userInput.trim()}\n            className=\"px-6 bg-indigo-600 hover:bg-indigo-700 rounded-full\"\n            onClick={handleNext}\n          >\n            {t('dashboard.newPlanDialog.next')}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NewPlanDialog; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,KAAQ,+BAA+B,CAC3D,OAASC,MAAM,KAAQ,+BAA+B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAGvD;AACA,KAAM,CAAAC,MAAM,CAAG,QAAAA,CAACC,OAAe,CAAqB,CAClD,GAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,YAAY,CAAE,SAAAC,IAAA,CAAAC,SAAA,CAAAC,MAAA,CADTC,IAAI,KAAAC,KAAA,CAAAJ,IAAA,GAAAA,IAAA,MAAAK,IAAA,GAAAA,IAAA,CAAAL,IAAA,CAAAK,IAAA,IAAJF,IAAI,CAAAE,IAAA,IAAAJ,SAAA,CAAAI,IAAA,GAEpCC,OAAO,CAACC,GAAG,CAACX,OAAO,CAAE,GAAGO,IAAI,CAAC,CAC/B,CACF,CAAC,CAOD,KAAM,CAAAK,aAA2C,CAAGC,IAAA,EAAyB,IAAxB,CAAEC,MAAM,CAAEC,OAAQ,CAAC,CAAAF,IAAA,CACtE,KAAM,CAAEG,CAAC,CAAEC,QAAS,CAAC,CAAGxB,WAAW,CAAC,CAAC,CACrC,KAAM,CAAAyB,QAAQ,CAAG1B,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAC2B,SAAS,CAAEC,YAAY,CAAC,CAAG9B,QAAQ,CAAC,EAAE,CAAC,CAE9CC,SAAS,CAAC,IAAM,CACd,GAAIuB,MAAM,CAAE,CACV;AACAM,YAAY,CAAC,EAAE,CAAC,CAEhB;AACA,KAAM,CAAAC,KAAK,CAAGC,UAAU,CAAC,IAAM,CAC7B,KAAM,CAAAC,QAAQ,CAAGC,QAAQ,CAACC,cAAc,CAAC,iBAAiB,CAAC,CAC3D,GAAIF,QAAQ,CAAE,CACZA,QAAQ,CAACG,KAAK,CAAC,CAAC,CAClB,CACF,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAMC,YAAY,CAACN,KAAK,CAAC,CAClC,CACF,CAAC,CAAE,CAACP,MAAM,CAAC,CAAC,CAEZ,GAAI,CAACA,MAAM,CAAE,MAAO,KAAI,CAExB,KAAM,CAAAc,YAAY,CAAGA,CAAA,GAAM,CACzBb,OAAO,CAAC,CAAC,CACX,CAAC,CAED,KAAM,CAAAc,UAAU,CAAGA,CAAA,GAAM,CACvB,GAAI,CAACV,SAAS,CAACW,IAAI,CAAC,CAAC,CAAE,OAEvB/B,MAAM,CAAC,mEAAmEoB,SAAS,CAACW,IAAI,CAAC,CAAC,EAAE,CAAC,CAE7F;AACA,KAAM,CAAAC,YAAY,CAAG,GAAI,CAAAC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAEhE;AACA,GAAIlC,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,YAAY,CAAE,CACzC;AACA,GAAI4B,YAAY,CAACK,GAAG,CAAC,SAAS,CAAC,GAAK,OAAO,CAAE,CAC3CL,YAAY,CAACM,GAAG,CAAC,SAAS,CAAE,MAAM,CAAC,CACrC,CACF,CAEA;AACA,KAAM,CAAAC,YAAY,CAAGP,YAAY,CAACQ,QAAQ,CAAC,CAAC,CAC5C,KAAM,CAAAC,WAAW,CAAGF,YAAY,CAAG,IAAIA,YAAY,EAAE,CAAG,EAAE,CAE1D;AACApB,QAAQ,CAAC,eAAesB,WAAW,EAAE,CAAE,CACrCC,KAAK,CAAE,CACLC,SAAS,CAAEvB,SAAS,CAACW,IAAI,CAAC,CAAC,CAC3Ba,IAAI,CAAE1B,QACR,CACF,CAAC,CAAC,CAEF;AACAF,OAAO,CAAC,CAAC,CACX,CAAC,CAED,mBACEnB,IAAA,QAAKgD,SAAS,CAAC,iEAAiE,CAAAC,QAAA,cAC9E/C,KAAA,QAAK8C,SAAS,CAAC,mEAAmE,CAAAC,QAAA,eAEhF/C,KAAA,QAAK8C,SAAS,CAAC,gEAAgE,CAAAC,QAAA,eAC7EjD,IAAA,OAAIgD,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAChD7B,CAAC,CAAC,+BAA+B,CAAC,CACjC,CAAC,cACLpB,IAAA,WACEkD,OAAO,CAAElB,YAAa,CACtBgB,SAAS,CAAC,sDAAsD,CAChE,aAAW,OAAO,CAAAC,QAAA,cAElB/C,KAAA,QAAKiD,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,KAAK,CAAC,4BAA4B,CAAAN,QAAA,eAC5FjD,IAAA,SAAMwD,CAAC,CAAC,YAAY,CAACC,MAAM,CAAC,cAAc,CAACC,WAAW,CAAC,GAAG,CAACC,aAAa,CAAC,OAAO,CAACC,cAAc,CAAC,OAAO,CAAC,CAAC,cACzG5D,IAAA,SAAMwD,CAAC,CAAC,YAAY,CAACC,MAAM,CAAC,cAAc,CAACC,WAAW,CAAC,GAAG,CAACC,aAAa,CAAC,OAAO,CAACC,cAAc,CAAC,OAAO,CAAC,CAAC,EACtG,CAAC,CACA,CAAC,EACN,CAAC,cAGN1D,KAAA,QAAK8C,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBjD,IAAA,UACE6D,OAAO,CAAC,iBAAiB,CACzBb,SAAS,CAAC,8CAA8C,CAAAC,QAAA,CAEvD7B,CAAC,CAAC,oCAAoC,CAAC,CACnC,CAAC,cACRpB,IAAA,aACE8D,EAAE,CAAC,iBAAiB,CACpBC,KAAK,CAAExC,SAAU,CACjByC,QAAQ,CAAGC,CAAC,EAAKzC,YAAY,CAACyC,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC9CI,WAAW,CAAE/C,CAAC,CAAC,qCAAqC,CAAE,CACtD4B,SAAS,CAAC,yKAAyK,CACnLoB,SAAS,CAAE,GAAI,CACfC,SAAS,MACV,CAAC,cACFnE,KAAA,QAAK8C,SAAS,CAAC,uCAAuC,CAAAC,QAAA,EACnD1B,SAAS,CAACb,MAAM,CAAC,MACpB,EAAK,CAAC,EACH,CAAC,cAGNR,KAAA,QAAK8C,SAAS,CAAC,6EAA6E,CAAAC,QAAA,eAC1FjD,IAAA,CAACF,MAAM,EACLwE,OAAO,CAAC,SAAS,CACjBtB,SAAS,CAAC,MAAM,CAChBE,OAAO,CAAElB,YAAa,CAAAiB,QAAA,CAErB7B,CAAC,CAAC,kBAAkB,CAAC,CAChB,CAAC,cACTpB,IAAA,CAACF,MAAM,EACLyE,IAAI,CAAC,QAAQ,CACbC,QAAQ,CAAE,CAACjD,SAAS,CAACW,IAAI,CAAC,CAAE,CAC5Bc,SAAS,CAAC,qDAAqD,CAC/DE,OAAO,CAAEjB,UAAW,CAAAgB,QAAA,CAEnB7B,CAAC,CAAC,8BAA8B,CAAC,CAC5B,CAAC,EACN,CAAC,EACH,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAJ,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}