{"ast":null,"code":"var _jsxFileName = \"/home/devbox/project/src/pages/workspace-page.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport AIChat from '../components/features/ai-chat/ai-chat';\nimport CommandPalette from '../components/features/command/command-palette';\nimport { usePlanStore } from '../lib/store';\nimport { toast } from 'sonner';\nimport ReactMarkdown from 'react-markdown';\n\n// 文件内容类型定义\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst WorkspacePage = () => {\n  _s();\n  const location = useLocation();\n  const {\n    plans\n  } = usePlanStore();\n  const [currentPlan, setCurrentPlan] = useState(null);\n  const [isLeftSidebarCollapsed, setIsLeftSidebarCollapsed] = useState(false);\n  const [leftSidebarWidth, setLeftSidebarWidth] = useState(256); // Default width of 64 in rem (w-64)\n  const [isLeftResizing, setIsLeftResizing] = useState(false);\n  const leftResizingRef = useRef(null);\n  const [isRightSidebarCollapsed, setIsRightSidebarCollapsed] = useState(false);\n  const [rightSidebarWidth, setRightSidebarWidth] = useState(384); // Default width of 96 in rem (w-96)\n  const [isResizing, setIsResizing] = useState(false);\n  const resizingRef = useRef(null);\n  const [isCommandPaletteOpen, setIsCommandPaletteOpen] = useState(false);\n  const [openFiles, setOpenFiles] = useState([]);\n  const [currentFile, setCurrentFile] = useState('');\n  const [fileContents, setFileContents] = useState({});\n\n  // 从URL获取planId并加载相应的计划\n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const planId = searchParams.get('planId');\n    if (planId && plans) {\n      const plan = plans.find(p => p.id === planId);\n      if (plan) {\n        setCurrentPlan(plan);\n\n        // 生成计划相关的文件内容\n        const planFiles = {\n          'plan-overview.md': generatePlanOverviewContent(plan),\n          'tasks.md': generateTasksContent(plan),\n          'progress.md': generateProgressContent(plan),\n          'notes.md': ''\n        };\n        setFileContents(prev => ({\n          ...prev,\n          ...planFiles\n        }));\n\n        // 设置默认打开的文件\n        setOpenFiles(Object.keys(planFiles));\n        setCurrentFile('plan-overview.md');\n      }\n    } else {\n      // 没有计划ID时显示默认工作区\n      const defaultContent = {\n        'workspace.txt': `# 任务计划 AI 工作区\n\n这是一个集成式AI工作环境，你可以：\n- 向AI提出关于任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`\n      };\n      setFileContents(prev => ({\n        ...prev,\n        ...defaultContent\n      }));\n      setOpenFiles(['workspace.txt']);\n      setCurrentFile('workspace.txt');\n    }\n  }, [location.search, plans]);\n\n  // 生成计划概览内容\n  const generatePlanOverviewContent = plan => {\n    return `# ${plan.title}\n\n## 描述\n${plan.description || '暂无描述'}\n\n## 意义\n${plan.significance || '暂无描述'}\n\n## 创建时间\n${plan.createdAt.toLocaleString()}\n\n## 计划状态\n${plan.status}\n\n## 总进度\n${plan.progress}%\n`;\n  };\n\n  // 生成任务内容\n  const generateTasksContent = plan => {\n    let content = `# ${plan.title} - 任务列表\\n\\n`;\n    if (plan.stages && plan.stages.length > 0) {\n      plan.stages.forEach(stage => {\n        content += `## ${stage.title}\\n\\n`;\n        if (stage.tasks && stage.tasks.length > 0) {\n          stage.tasks.forEach(task => {\n            content += `- [${task.completed ? 'x' : ' '}] ${task.title}\\n`;\n            if (task.description) {\n              content += `  ${task.description}\\n`;\n            }\n          });\n        } else {\n          content += `暂无任务\\n`;\n        }\n        content += '\\n';\n      });\n    } else {\n      content += '暂无任务阶段\\n';\n    }\n    return content;\n  };\n\n  // 生成进度内容\n  const generateProgressContent = plan => {\n    var _plan$stages$find;\n    return `# ${plan.title} - 进度跟踪\n\n## 总体进度\n${plan.progress}% 完成\n\n## 当前阶段\n${((_plan$stages$find = plan.stages.find(s => s.id === plan.currentStageId)) === null || _plan$stages$find === void 0 ? void 0 : _plan$stages$find.title) || '未设置'}\n\n## 延迟情况\n${plan.delayedDays ? `已延迟 ${plan.delayedDays} 天` : '按时进行中'}\n\n## AI互动次数\n${plan.aiInteractions || 0} 次\n\n## 最近更新\n${plan.updatedAt.toLocaleString()}\n`;\n  };\n\n  // 定义可用命令\n  const commands = [{\n    id: 'new-file',\n    name: '新建文件',\n    description: '创建一个新的文件',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M12 4v16m8-8H4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      const fileName = prompt('请输入文件名:');\n      if (fileName && !openFiles.includes(fileName)) {\n        setOpenFiles(prev => [...prev, fileName]);\n        setFileContents(prev => ({\n          ...prev,\n          [fileName]: ''\n        }));\n        setCurrentFile(fileName);\n        toast.success(`文件 ${fileName} 已创建`);\n      }\n    }\n  }, {\n    id: 'toggle-left-sidebar',\n    name: '切换左侧栏',\n    description: '显示或隐藏左侧文件栏',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M4 6h16M4 12h16M4 18h7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed);\n    }\n  }, {\n    id: 'toggle-right-sidebar',\n    name: '切换AI助手',\n    description: '显示或隐藏右侧AI助手',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsRightSidebarCollapsed(!isRightSidebarCollapsed);\n    }\n  }, {\n    id: 'ask-ai',\n    name: '询问AI',\n    description: '直接向AI助手提问',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      setIsRightSidebarCollapsed(false);\n      toast.info('请在AI助手栏中提问');\n    }\n  }, {\n    id: 'go-to-dashboard',\n    name: '返回任务计划',\n    description: '返回到任务计划页面',\n    icon: /*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"w-5 h-5\",\n      fill: \"none\",\n      stroke: \"currentColor\",\n      viewBox: \"0 0 24 24\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        strokeLinecap: \"round\",\n        strokeLinejoin: \"round\",\n        strokeWidth: 2,\n        d: \"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 9\n    }, this),\n    action: () => {\n      window.location.href = '/dashboard';\n    }\n  }];\n\n  // 处理AI消息\n  const handleSendMessage = async (message, references) => {\n    // 模拟AI响应\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let response = '';\n\n        // 根据消息内容模拟不同的响应\n        if (message.toLowerCase().includes('任务拆解')) {\n          response = `我可以帮你拆解任务。一个好的任务拆解应该包含以下几个步骤：\n\n1. 明确任务目标\n2. 将大任务分解为小任务\n3. 评估每个小任务的优先级\n4. 设定每个小任务的完成时间\n5. 分配资源\n\n希望这对你有所帮助！`;\n        } else if (message.toLowerCase().includes('优化')) {\n          response = `要优化你的任务计划，可以考虑以下几点：\n\n1. 使用番茄工作法提高专注度\n2. 建立例行公事，减少决策疲劳\n3. 批量处理同类型的任务\n4. 定期回顾和调整你的计划\n5. 使用自动化工具减少重复工作`;\n        } else if (references && references.length > 0) {\n          // 如果有引用文件，基于文件内容给出响应\n          const fileContent = references.map(file => fileContents[file] || `(无法读取文件 ${file})`).join('\\n\\n');\n          response = `我已分析了你引用的文件。以下是我的发现：\n\n根据文件内容，这是一个使用React框架构建的任务管理应用。主要组件包括计划树(plan-tree)、工作区和仪表盘。\n\n我建议你可以：\n1. 检查组件之间的数据流是否清晰\n2. 确保状态管理逻辑集中且一致\n3. 考虑添加单元测试确保功能稳定性`;\n        } else {\n          response = `我是你的AI助手，可以帮助你:\n\n- 回答关于任务管理的问题\n- 提供任务拆解和优化建议\n- 分析项目文件和代码\n\n你可以尝试询问关于\"任务拆解\"或\"优化\"的问题，或者使用@引用特定文件，我会基于文件内容给你更具体的建议。`;\n        }\n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 监听快捷键\n  useEffect(() => {\n    const handleKeyDown = e => {\n      // 检查Cmd+K或Ctrl+K\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault();\n        setIsCommandPaletteOpen(true);\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, []);\n\n  // 处理左侧边栏拖拽调整宽度\n  const handleLeftResizeMouseDown = e => {\n    e.preventDefault();\n    setIsLeftResizing(true);\n    leftResizingRef.current = {\n      startX: e.clientX,\n      startWidth: leftSidebarWidth\n    };\n  };\n  useEffect(() => {\n    const handleLeftResizeMouseMove = e => {\n      if (!isLeftResizing || !leftResizingRef.current) return;\n      const delta = e.clientX - leftResizingRef.current.startX;\n      const newWidth = Math.max(200, Math.min(500, leftResizingRef.current.startWidth + delta));\n      setLeftSidebarWidth(newWidth);\n    };\n    const handleLeftResizeMouseUp = () => {\n      setIsLeftResizing(false);\n      leftResizingRef.current = null;\n    };\n    if (isLeftResizing) {\n      document.addEventListener('mousemove', handleLeftResizeMouseMove);\n      document.addEventListener('mouseup', handleLeftResizeMouseUp);\n    }\n    return () => {\n      document.removeEventListener('mousemove', handleLeftResizeMouseMove);\n      document.removeEventListener('mouseup', handleLeftResizeMouseUp);\n    };\n  }, [isLeftResizing]);\n\n  // 处理右侧边栏拖拽调整宽度\n  const handleResizeMouseDown = e => {\n    e.preventDefault();\n    setIsResizing(true);\n    resizingRef.current = {\n      startX: e.clientX,\n      startWidth: rightSidebarWidth\n    };\n  };\n  useEffect(() => {\n    const handleResizeMouseMove = e => {\n      if (!isResizing || !resizingRef.current) return;\n      const delta = resizingRef.current.startX - e.clientX;\n      const newWidth = Math.max(280, Math.min(800, resizingRef.current.startWidth + delta));\n      setRightSidebarWidth(newWidth);\n    };\n    const handleResizeMouseUp = () => {\n      setIsResizing(false);\n      resizingRef.current = null;\n    };\n    if (isResizing) {\n      document.addEventListener('mousemove', handleResizeMouseMove);\n      document.addEventListener('mouseup', handleResizeMouseUp);\n    }\n    return () => {\n      document.removeEventListener('mousemove', handleResizeMouseMove);\n      document.removeEventListener('mouseup', handleResizeMouseUp);\n    };\n  }, [isResizing]);\n\n  // 渲染文件内容的函数\n  const renderFileContent = content => {\n    if (!content) return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 text-gray-500\",\n      children: \"\\u7A7A\\u6587\\u4EF6\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 26\n    }, this);\n\n    // 对于markdown文件使用markdown渲染\n    if (currentFile.endsWith('.md')) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 prose prose-sm max-w-none\",\n        children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n          children: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this);\n    }\n\n    // 对于普通文本或代码文件使用预格式化文本\n    return /*#__PURE__*/_jsxDEV(\"pre\", {\n      className: \"p-4 font-mono text-sm whitespace-pre-wrap\",\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen w-screen flex overflow-hidden bg-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: `bg-gray-800 text-white flex flex-col transition-all ${isLeftSidebarCollapsed ? 'w-12' : ''}`,\n      style: {\n        width: isLeftSidebarCollapsed ? '3rem' : `${leftSidebarWidth}px`\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between p-4 border-b border-gray-700\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: `font-medium ${isLeftSidebarCollapsed ? 'hidden' : 'block'}`,\n          children: \"\\u6587\\u4EF6\\u6D4F\\u89C8\\u5668\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed),\n          className: \"text-gray-400 hover:text-white\",\n          children: isLeftSidebarCollapsed ? /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M13 5l7 7-7 7M5 5l7 7-7 7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M11 19l-7-7 7-7m8 14l-7-7 7-7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-auto p-2\",\n        children: !isLeftSidebarCollapsed && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"py-2\",\n          children: Object.keys(fileContents).map(fileName => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex items-center ${fileName === currentFile ? 'text-white bg-gray-700' : 'text-gray-300 hover:text-white'} py-1 px-2 rounded hover:bg-gray-700 cursor-pointer`,\n            onClick: () => {\n              if (!openFiles.includes(fileName)) {\n                setOpenFiles(prev => [...prev, fileName]);\n              }\n              setCurrentFile(fileName);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5 mr-2 flex-shrink-0\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"truncate\",\n              children: fileName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 19\n            }, this)]\n          }, fileName, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-1 flex flex-col h-full overflow-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-700 text-white h-12 flex items-center px-2 space-x-1 overflow-x-auto\",\n        children: openFiles.map(file => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `px-3 py-1 rounded-t-md text-sm flex items-center space-x-2 ${currentFile === file ? 'bg-gray-100 text-gray-800' : 'bg-gray-600 text-gray-200 hover:bg-gray-500'}`,\n          onClick: () => setCurrentFile(file),\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: file\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 15\n          }, this), currentFile === file && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ml-2 text-gray-500 hover:text-gray-700\",\n            onClick: e => {\n              e.stopPropagation();\n              // 关闭文件标签的逻辑\n              setOpenFiles(prev => prev.filter(f => f !== file));\n              if (currentFile === file) {\n                // 如果关闭的是当前文件，选择下一个文件\n                const index = openFiles.indexOf(file);\n                if (index > 0) {\n                  setCurrentFile(openFiles[index - 1]);\n                } else if (openFiles.length > 1) {\n                  setCurrentFile(openFiles[1]);\n                }\n              }\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 17\n          }, this)]\n        }, file, true, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 overflow-auto bg-white\",\n        children: currentFile && fileContents[currentFile] ? renderFileContent(fileContents[currentFile]) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-center h-full text-gray-400\",\n          children: \"\\u8BF7\\u9009\\u62E9\\u6216\\u521B\\u5EFA\\u4E00\\u4E2A\\u6587\\u4EF6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: `bg-gray-50 border-l border-gray-200 flex flex-col ${isRightSidebarCollapsed ? 'w-0' : ''}`,\n      style: {\n        width: isRightSidebarCollapsed ? '0' : `${rightSidebarWidth}px`\n      },\n      children: [!isRightSidebarCollapsed && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-12 border-b border-gray-200 flex items-center justify-between px-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"font-medium text-gray-800\",\n            children: \"AI \\u52A9\\u624B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"text-gray-500 hover:text-gray-700\",\n            onClick: () => setIsRightSidebarCollapsed(true),\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-5 h-5\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M6 18L18 6M6 6l12 12\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-hidden\",\n          children: /*#__PURE__*/_jsxDEV(AIChat, {\n            onSendMessage: handleSendMessage,\n            availableFiles: openFiles\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), !isRightSidebarCollapsed && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-0 left-0 w-1 h-full cursor-ew-resize bg-transparent hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity\",\n        onMouseDown: handleResizeMouseDown\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 7\n    }, this), isCommandPaletteOpen && /*#__PURE__*/_jsxDEV(CommandPalette, {\n      commands: commands,\n      onClose: () => setIsCommandPaletteOpen(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 525,\n      columnNumber: 9\n    }, this), isRightSidebarCollapsed && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"fixed right-4 bottom-4 bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700\",\n      onClick: () => setIsRightSidebarCollapsed(false),\n      \"aria-label\": \"Open AI Assistant\",\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"w-6 h-6\",\n        fill: \"none\",\n        stroke: \"currentColor\",\n        viewBox: \"0 0 24 24\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 533,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 388,\n    columnNumber: 5\n  }, this);\n};\n_s(WorkspacePage, \"DkJfp9OiEioj0Vm8hDUe4a7RfOk=\", false, function () {\n  return [useLocation, usePlanStore];\n});\n_c = WorkspacePage;\nexport default WorkspacePage;\nvar _c;\n$RefreshReg$(_c, \"WorkspacePage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useLocation","AIChat","CommandPalette","usePlanStore","toast","ReactMarkdown","jsxDEV","_jsxDEV","Fragment","_Fragment","WorkspacePage","_s","location","plans","currentPlan","setCurrentPlan","isLeftSidebarCollapsed","setIsLeftSidebarCollapsed","leftSidebarWidth","setLeftSidebarWidth","isLeftResizing","setIsLeftResizing","leftResizingRef","isRightSidebarCollapsed","setIsRightSidebarCollapsed","rightSidebarWidth","setRightSidebarWidth","isResizing","setIsResizing","resizingRef","isCommandPaletteOpen","setIsCommandPaletteOpen","openFiles","setOpenFiles","currentFile","setCurrentFile","fileContents","setFileContents","searchParams","URLSearchParams","search","planId","get","plan","find","p","id","planFiles","generatePlanOverviewContent","generateTasksContent","generateProgressContent","prev","Object","keys","defaultContent","title","description","significance","createdAt","toLocaleString","status","progress","content","stages","length","forEach","stage","tasks","task","completed","_plan$stages$find","s","currentStageId","delayedDays","aiInteractions","updatedAt","commands","name","icon","className","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","action","prompt","includes","success","info","window","href","handleSendMessage","message","references","Promise","resolve","setTimeout","response","toLowerCase","fileContent","map","file","join","handleKeyDown","e","metaKey","ctrlKey","key","preventDefault","addEventListener","removeEventListener","handleLeftResizeMouseDown","current","startX","clientX","startWidth","handleLeftResizeMouseMove","delta","newWidth","Math","max","min","handleLeftResizeMouseUp","document","handleResizeMouseDown","handleResizeMouseMove","handleResizeMouseUp","renderFileContent","endsWith","style","width","onClick","stopPropagation","filter","f","index","indexOf","onSendMessage","availableFiles","onMouseDown","onClose","_c","$RefreshReg$"],"sources":["/home/devbox/project/src/pages/workspace-page.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { Button } from '../components/ui/button';\nimport AIChat, { Message } from '../components/features/ai-chat/ai-chat';\nimport CommandPalette from '../components/features/command/command-palette';\nimport { usePlanStore } from '../lib/store';\nimport { toast } from 'sonner';\nimport { Plan } from '../types/task';\nimport ReactMarkdown from 'react-markdown';\n\n// 文件内容类型定义\ninterface FileContents {\n  [key: string]: string;\n}\n\nconst WorkspacePage: React.FC = () => {\n  const location = useLocation();\n  const { plans } = usePlanStore();\n  const [currentPlan, setCurrentPlan] = useState<Plan | null>(null);\n  \n  const [isLeftSidebarCollapsed, setIsLeftSidebarCollapsed] = useState(false);\n  const [leftSidebarWidth, setLeftSidebarWidth] = useState(256); // Default width of 64 in rem (w-64)\n  const [isLeftResizing, setIsLeftResizing] = useState(false);\n  const leftResizingRef = useRef<{ startX: number; startWidth: number } | null>(null);\n  \n  const [isRightSidebarCollapsed, setIsRightSidebarCollapsed] = useState(false);\n  const [rightSidebarWidth, setRightSidebarWidth] = useState(384); // Default width of 96 in rem (w-96)\n  const [isResizing, setIsResizing] = useState(false);\n  const resizingRef = useRef<{ startX: number; startWidth: number } | null>(null);\n  \n  const [isCommandPaletteOpen, setIsCommandPaletteOpen] = useState(false);\n  const [openFiles, setOpenFiles] = useState<string[]>([]);\n  const [currentFile, setCurrentFile] = useState<string>('');\n  const [fileContents, setFileContents] = useState<FileContents>({});\n\n  // 从URL获取planId并加载相应的计划\n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const planId = searchParams.get('planId');\n    \n    if (planId && plans) {\n      const plan = plans.find(p => p.id === planId);\n      if (plan) {\n        setCurrentPlan(plan);\n        \n        // 生成计划相关的文件内容\n        const planFiles: FileContents = {\n          'plan-overview.md': generatePlanOverviewContent(plan),\n          'tasks.md': generateTasksContent(plan),\n          'progress.md': generateProgressContent(plan),\n          'notes.md': ''\n        };\n        \n        setFileContents(prev => ({...prev, ...planFiles}));\n        \n        // 设置默认打开的文件\n        setOpenFiles(Object.keys(planFiles));\n        setCurrentFile('plan-overview.md');\n      }\n    } else {\n      // 没有计划ID时显示默认工作区\n      const defaultContent = {\n        'workspace.txt': `# 任务计划 AI 工作区\n\n这是一个集成式AI工作环境，你可以：\n- 向AI提出关于任务的问题\n- 获取关于任务拆解的建议\n- 使用AI协助管理和优化你的任务计划\n\n## 使用方法\n\n1. 在右侧AI助手中提问\n2. 使用⌘K打开命令面板\n3. 使用@符号引用文件和资源`\n      };\n      \n      setFileContents(prev => ({...prev, ...defaultContent}));\n      setOpenFiles(['workspace.txt']);\n      setCurrentFile('workspace.txt');\n    }\n  }, [location.search, plans]);\n\n  // 生成计划概览内容\n  const generatePlanOverviewContent = (plan: Plan): string => {\n    return `# ${plan.title}\n\n## 描述\n${plan.description || '暂无描述'}\n\n## 意义\n${plan.significance || '暂无描述'}\n\n## 创建时间\n${plan.createdAt.toLocaleString()}\n\n## 计划状态\n${plan.status}\n\n## 总进度\n${plan.progress}%\n`;\n  };\n\n  // 生成任务内容\n  const generateTasksContent = (plan: Plan): string => {\n    let content = `# ${plan.title} - 任务列表\\n\\n`;\n    \n    if (plan.stages && plan.stages.length > 0) {\n      plan.stages.forEach(stage => {\n        content += `## ${stage.title}\\n\\n`;\n        \n        if (stage.tasks && stage.tasks.length > 0) {\n          stage.tasks.forEach(task => {\n            content += `- [${task.completed ? 'x' : ' '}] ${task.title}\\n`;\n            if (task.description) {\n              content += `  ${task.description}\\n`;\n            }\n          });\n        } else {\n          content += `暂无任务\\n`;\n        }\n        \n        content += '\\n';\n      });\n    } else {\n      content += '暂无任务阶段\\n';\n    }\n    \n    return content;\n  };\n\n  // 生成进度内容\n  const generateProgressContent = (plan: Plan): string => {\n    return `# ${plan.title} - 进度跟踪\n\n## 总体进度\n${plan.progress}% 完成\n\n## 当前阶段\n${plan.stages.find(s => s.id === plan.currentStageId)?.title || '未设置'}\n\n## 延迟情况\n${plan.delayedDays ? `已延迟 ${plan.delayedDays} 天` : '按时进行中'}\n\n## AI互动次数\n${plan.aiInteractions || 0} 次\n\n## 最近更新\n${plan.updatedAt.toLocaleString()}\n`;\n  };\n\n  // 定义可用命令\n  const commands = [\n    {\n      id: 'new-file',\n      name: '新建文件',\n      description: '创建一个新的文件',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\n        </svg>\n      ),\n      action: () => {\n        const fileName = prompt('请输入文件名:');\n        if (fileName && !openFiles.includes(fileName)) {\n          setOpenFiles(prev => [...prev, fileName]);\n          setFileContents(prev => ({\n            ...prev,\n            [fileName]: ''\n          }));\n          setCurrentFile(fileName);\n          toast.success(`文件 ${fileName} 已创建`);\n        }\n      }\n    },\n    {\n      id: 'toggle-left-sidebar',\n      name: '切换左侧栏',\n      description: '显示或隐藏左侧文件栏',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h7\" />\n        </svg>\n      ),\n      action: () => {\n        setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed);\n      }\n    },\n    {\n      id: 'toggle-right-sidebar',\n      name: '切换AI助手',\n      description: '显示或隐藏右侧AI助手',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n        </svg>\n      ),\n      action: () => {\n        setIsRightSidebarCollapsed(!isRightSidebarCollapsed);\n      }\n    },\n    {\n      id: 'ask-ai',\n      name: '询问AI',\n      description: '直接向AI助手提问',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n        </svg>\n      ),\n      action: () => {\n        setIsRightSidebarCollapsed(false);\n        toast.info('请在AI助手栏中提问');\n      }\n    },\n    {\n      id: 'go-to-dashboard',\n      name: '返回任务计划',\n      description: '返回到任务计划页面',\n      icon: (\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\" />\n        </svg>\n      ),\n      action: () => {\n        window.location.href = '/dashboard';\n      }\n    }\n  ];\n\n  // 处理AI消息\n  const handleSendMessage = async (message: string, references?: string[]): Promise<string> => {\n    // 模拟AI响应\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        let response = '';\n        \n        // 根据消息内容模拟不同的响应\n        if (message.toLowerCase().includes('任务拆解')) {\n          response = `我可以帮你拆解任务。一个好的任务拆解应该包含以下几个步骤：\n\n1. 明确任务目标\n2. 将大任务分解为小任务\n3. 评估每个小任务的优先级\n4. 设定每个小任务的完成时间\n5. 分配资源\n\n希望这对你有所帮助！`;\n        } else if (message.toLowerCase().includes('优化')) {\n          response = `要优化你的任务计划，可以考虑以下几点：\n\n1. 使用番茄工作法提高专注度\n2. 建立例行公事，减少决策疲劳\n3. 批量处理同类型的任务\n4. 定期回顾和调整你的计划\n5. 使用自动化工具减少重复工作`;\n        } else if (references && references.length > 0) {\n          // 如果有引用文件，基于文件内容给出响应\n          const fileContent = references.map(file => fileContents[file] || `(无法读取文件 ${file})`).join('\\n\\n');\n          response = `我已分析了你引用的文件。以下是我的发现：\n\n根据文件内容，这是一个使用React框架构建的任务管理应用。主要组件包括计划树(plan-tree)、工作区和仪表盘。\n\n我建议你可以：\n1. 检查组件之间的数据流是否清晰\n2. 确保状态管理逻辑集中且一致\n3. 考虑添加单元测试确保功能稳定性`;\n        } else {\n          response = `我是你的AI助手，可以帮助你:\n\n- 回答关于任务管理的问题\n- 提供任务拆解和优化建议\n- 分析项目文件和代码\n\n你可以尝试询问关于\"任务拆解\"或\"优化\"的问题，或者使用@引用特定文件，我会基于文件内容给你更具体的建议。`;\n        }\n        \n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 监听快捷键\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // 检查Cmd+K或Ctrl+K\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault();\n        setIsCommandPaletteOpen(true);\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, []);\n\n  // 处理左侧边栏拖拽调整宽度\n  const handleLeftResizeMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    setIsLeftResizing(true);\n    leftResizingRef.current = {\n      startX: e.clientX,\n      startWidth: leftSidebarWidth\n    };\n  };\n\n  useEffect(() => {\n    const handleLeftResizeMouseMove = (e: MouseEvent) => {\n      if (!isLeftResizing || !leftResizingRef.current) return;\n      \n      const delta = e.clientX - leftResizingRef.current.startX;\n      const newWidth = Math.max(200, Math.min(500, leftResizingRef.current.startWidth + delta));\n      setLeftSidebarWidth(newWidth);\n    };\n\n    const handleLeftResizeMouseUp = () => {\n      setIsLeftResizing(false);\n      leftResizingRef.current = null;\n    };\n\n    if (isLeftResizing) {\n      document.addEventListener('mousemove', handleLeftResizeMouseMove);\n      document.addEventListener('mouseup', handleLeftResizeMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('mousemove', handleLeftResizeMouseMove);\n      document.removeEventListener('mouseup', handleLeftResizeMouseUp);\n    };\n  }, [isLeftResizing]);\n\n  // 处理右侧边栏拖拽调整宽度\n  const handleResizeMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    setIsResizing(true);\n    resizingRef.current = {\n      startX: e.clientX,\n      startWidth: rightSidebarWidth\n    };\n  };\n\n  useEffect(() => {\n    const handleResizeMouseMove = (e: MouseEvent) => {\n      if (!isResizing || !resizingRef.current) return;\n      \n      const delta = resizingRef.current.startX - e.clientX;\n      const newWidth = Math.max(280, Math.min(800, resizingRef.current.startWidth + delta));\n      setRightSidebarWidth(newWidth);\n    };\n\n    const handleResizeMouseUp = () => {\n      setIsResizing(false);\n      resizingRef.current = null;\n    };\n\n    if (isResizing) {\n      document.addEventListener('mousemove', handleResizeMouseMove);\n      document.addEventListener('mouseup', handleResizeMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('mousemove', handleResizeMouseMove);\n      document.removeEventListener('mouseup', handleResizeMouseUp);\n    };\n  }, [isResizing]);\n\n  // 渲染文件内容的函数\n  const renderFileContent = (content: string) => {\n    if (!content) return <div className=\"p-4 text-gray-500\">空文件</div>;\n    \n    // 对于markdown文件使用markdown渲染\n    if (currentFile.endsWith('.md')) {\n      return (\n        <div className=\"p-4 prose prose-sm max-w-none\">\n          <ReactMarkdown>{content}</ReactMarkdown>\n        </div>\n      );\n    }\n    \n    // 对于普通文本或代码文件使用预格式化文本\n    return (\n      <pre className=\"p-4 font-mono text-sm whitespace-pre-wrap\">{content}</pre>\n    );\n  };\n\n  return (\n    <div className=\"h-screen w-screen flex overflow-hidden bg-gray-100\">\n      {/* 左侧文件浏览器 */}\n      <aside \n        className={`bg-gray-800 text-white flex flex-col transition-all ${isLeftSidebarCollapsed ? 'w-12' : ''}`}\n        style={{ width: isLeftSidebarCollapsed ? '3rem' : `${leftSidebarWidth}px` }}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-700\">\n          <h2 className={`font-medium ${isLeftSidebarCollapsed ? 'hidden' : 'block'}`}>文件浏览器</h2>\n          <button \n            onClick={() => setIsLeftSidebarCollapsed(!isLeftSidebarCollapsed)}\n            className=\"text-gray-400 hover:text-white\"\n          >\n            {isLeftSidebarCollapsed ? (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 5l7 7-7 7M5 5l7 7-7 7\" />\n              </svg>\n            ) : (\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 19l-7-7 7-7m8 14l-7-7 7-7\" />\n              </svg>\n            )}\n          </button>\n        </div>\n        \n        {/* 文件树组件 */}\n        <div className=\"flex-1 overflow-auto p-2\">\n          {!isLeftSidebarCollapsed && (\n            <div className=\"py-2\">\n              {Object.keys(fileContents).map(fileName => (\n                <div \n                  key={fileName}\n                  className={`flex items-center ${fileName === currentFile ? 'text-white bg-gray-700' : 'text-gray-300 hover:text-white'} py-1 px-2 rounded hover:bg-gray-700 cursor-pointer`}\n                  onClick={() => {\n                    if (!openFiles.includes(fileName)) {\n                      setOpenFiles(prev => [...prev, fileName]);\n                    }\n                    setCurrentFile(fileName);\n                  }}\n                >\n                  <svg className=\"w-5 h-5 mr-2 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\n                  </svg>\n                  <span className=\"truncate\">{fileName}</span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </aside>\n\n      {/* 中间编辑器区域 */}\n      <main className=\"flex-1 flex flex-col h-full overflow-auto\">\n        {/* 文件标签栏 */}\n        <div className=\"bg-gray-700 text-white h-12 flex items-center px-2 space-x-1 overflow-x-auto\">\n          {openFiles.map(file => (\n            <button\n              key={file}\n              className={`px-3 py-1 rounded-t-md text-sm flex items-center space-x-2 ${\n                currentFile === file ? 'bg-gray-100 text-gray-800' : 'bg-gray-600 text-gray-200 hover:bg-gray-500'\n              }`}\n              onClick={() => setCurrentFile(file)}\n            >\n              <span>{file}</span>\n              {currentFile === file && (\n                <span\n                  className=\"ml-2 text-gray-500 hover:text-gray-700\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    // 关闭文件标签的逻辑\n                    setOpenFiles(prev => prev.filter(f => f !== file));\n                    if (currentFile === file) {\n                      // 如果关闭的是当前文件，选择下一个文件\n                      const index = openFiles.indexOf(file);\n                      if (index > 0) {\n                        setCurrentFile(openFiles[index - 1]);\n                      } else if (openFiles.length > 1) {\n                        setCurrentFile(openFiles[1]);\n                      }\n                    }\n                  }}\n                >\n                  ×\n                </span>\n              )}\n            </button>\n          ))}\n        </div>\n\n        {/* 文件内容区域 */}\n        <div className=\"flex-1 overflow-auto bg-white\">\n          {currentFile && fileContents[currentFile] ? (\n            renderFileContent(fileContents[currentFile])\n          ) : (\n            <div className=\"flex items-center justify-center h-full text-gray-400\">\n              请选择或创建一个文件\n            </div>\n          )}\n        </div>\n      </main>\n\n      {/* AI助手侧边栏 */}\n      <aside\n        className={`bg-gray-50 border-l border-gray-200 flex flex-col ${isRightSidebarCollapsed ? 'w-0' : ''}`}\n        style={{ width: isRightSidebarCollapsed ? '0' : `${rightSidebarWidth}px` }}\n      >\n        {!isRightSidebarCollapsed && (\n          <>\n            <div className=\"h-12 border-b border-gray-200 flex items-center justify-between px-4\">\n              <h2 className=\"font-medium text-gray-800\">AI 助手</h2>\n              <button\n                className=\"text-gray-500 hover:text-gray-700\"\n                onClick={() => setIsRightSidebarCollapsed(true)}\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n            <div className=\"flex-1 overflow-hidden\">\n              <AIChat \n                onSendMessage={handleSendMessage} \n                availableFiles={openFiles}\n              />\n            </div>\n          </>\n        )}\n        {/* 拖拽区域 */}\n        {!isRightSidebarCollapsed && (\n          <div\n            className=\"absolute top-0 left-0 w-1 h-full cursor-ew-resize bg-transparent hover:bg-blue-500 opacity-0 hover:opacity-100 transition-opacity\"\n            onMouseDown={handleResizeMouseDown}\n          />\n        )}\n      </aside>\n\n      {/* 命令面板 */}\n      {isCommandPaletteOpen && (\n        <CommandPalette\n          commands={commands}\n          onClose={() => setIsCommandPaletteOpen(false)}\n        />\n      )}\n\n      {/* 折叠状态下的右侧展开按钮 */}\n      {isRightSidebarCollapsed && (\n        <button\n          className=\"fixed right-4 bottom-4 bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700\"\n          onClick={() => setIsRightSidebarCollapsed(false)}\n          aria-label=\"Open AI Assistant\"\n        >\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n            />\n          </svg>\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default WorkspacePage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}