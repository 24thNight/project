{"ast":null,"code":"var _jsxFileName = \"/home/devbox/project/src/components/features/ai-chat/ai-chat.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Button } from '../../ui/button';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from './message-bubble';\nimport ThinkingIndicator from './thinking-indicator';\nimport { toast } from 'sonner';\n\n// 定义消息类型\n\n// 定义AI模型类型\n\n// 定义AI模式类型\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AIChat = ({\n  initialMessages = [],\n  onSendMessage\n}) => {\n  _s();\n  const [messages, setMessages] = useState(initialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [status, setStatus] = useState('idle');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [selectedModel, setSelectedModel] = useState('claude-3.7-sonnet');\n  const [mode, setMode] = useState('agent');\n  const [isModelDropdownOpen, setIsModelDropdownOpen] = useState(false);\n  const [isModeDropdownOpen, setIsModeDropdownOpen] = useState(false);\n  const [references, setReferences] = useState([]);\n  const [showReferenceSelector, setShowReferenceSelector] = useState(false);\n  const [imageUrl, setImageUrl] = useState(undefined);\n  const [isRecording, setIsRecording] = useState(false);\n  const [availableFiles, setAvailableFiles] = useState(['workspace.txt', 'project.json', 'README.md', 'src/components/features/plan-tree/plan-tree.tsx']);\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n  const modelDropdownRef = useRef(null);\n  const modeDropdownRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // 处理点击外部关闭下拉菜单\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (modelDropdownRef.current && !modelDropdownRef.current.contains(event.target)) {\n        setIsModelDropdownOpen(false);\n      }\n      if (modeDropdownRef.current && !modeDropdownRef.current.contains(event.target)) {\n        setIsModeDropdownOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n\n  // 自动调整输入框高度\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 200)}px`;\n    }\n  }, [inputValue]);\n  const generateId = () => {\n    return Date.now().toString(36) + Math.random().toString(36).substring(2);\n  };\n  const handleSendMessage = async () => {\n    if (!inputValue.trim() && !imageUrl && status !== 'idle') return;\n\n    // 创建用户消息\n    const userMessage = {\n      id: generateId(),\n      role: 'user',\n      content: inputValue,\n      timestamp: new Date(),\n      references: references.length > 0 ? [...references] : undefined,\n      imageUrl\n    };\n\n    // 更新状态并清空输入\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setReferences([]);\n    setImageUrl(undefined);\n    setShowReferenceSelector(false);\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n    }\n    setStatus('thinking');\n    try {\n      // 如果没有提供onSendMessage回调，使用模拟响应\n      const response = onSendMessage ? await onSendMessage(inputValue, references, imageUrl) : await simulateResponse(inputValue, references, imageUrl);\n\n      // 添加AI回复\n      const assistantMessage = {\n        id: generateId(),\n        role: 'assistant',\n        content: response,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n      setStatus('idle');\n    } catch (error) {\n      console.error('Failed to get AI response:', error);\n      setStatus('error');\n\n      // 添加错误消息\n      const errorMessage = {\n        id: generateId(),\n        role: 'system',\n        content: '抱歉，发生了错误。请稍后再试。',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, errorMessage]);\n      setTimeout(() => setStatus('idle'), 3000);\n    }\n  };\n\n  // 模拟AI响应，仅用于演示\n  const simulateResponse = async (message, refs, img) => {\n    // 返回模拟的响应\n    return new Promise(resolve => {\n      const responses = [\"我理解你的问题。让我帮你分析一下...\", \"这是一个很好的问题。根据我的分析...\", \"我可以协助你解决这个问题。首先，你需要...\", \"让我思考一下最佳的解决方案。\", \"根据最新的研究和最佳实践，我建议...\"];\n      let response = responses[Math.floor(Math.random() * responses.length)];\n      if (message) {\n        response += ` 你的问题是关于\"${message}\"的。`;\n      }\n\n      // 如果有引用文件，添加相关内容\n      if (refs && refs.length > 0) {\n        response += ` 我已查看了你引用的文件: ${refs.join(', ')}。`;\n      }\n\n      // 如果有图片，添加相关内容\n      if (img) {\n        response += \" 我已分析了你上传的图片。\";\n      }\n      if (mode === 'agent') {\n        response += \" 作为智能体模式，我会主动帮你执行任务和提供解决方案。\";\n      } else if (mode === 'chat') {\n        response += \" 作为对话模式，我会回答你的问题，但不会主动执行任务。\";\n      } else {\n        response += \" 作为手动模式，我需要你指导我该如何进行操作。\";\n      }\n\n      // 模拟网络延迟\n      setTimeout(() => {\n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 处理输入值变化\n  const handleInputChange = e => {\n    const value = e.target.value;\n    setInputValue(value);\n\n    // 检测是否输入了@符号\n    if (value.endsWith('@') && !showReferenceSelector) {\n      setShowReferenceSelector(true);\n    }\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    } else if (e.key === '@') {\n      setShowReferenceSelector(true);\n    } else if (e.key === 'Escape') {\n      setShowReferenceSelector(false);\n      setIsModelDropdownOpen(false);\n      setIsModeDropdownOpen(false);\n    }\n  };\n  const handleReferenceSelect = file => {\n    if (!references.includes(file)) {\n      setReferences(prev => [...prev, file]);\n      toast.success(`已引用 ${file}`);\n    }\n    setShowReferenceSelector(false);\n  };\n  const handleRemoveReference = file => {\n    setReferences(prev => prev.filter(ref => ref !== file));\n  };\n  const handleImageUpload = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file) {\n      // 在实际应用中，你可能需要将文件上传到服务器并获取URL\n      // 这里我们仅模拟这个过程，生成一个临时的对象URL\n      const tempUrl = URL.createObjectURL(file);\n      setImageUrl(tempUrl);\n      toast.success(`已上传图片: ${file.name}`);\n    }\n  };\n  const handleVoiceInput = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      toast.error('您的浏览器不支持语音识别功能');\n      return;\n    }\n    setIsRecording(!isRecording);\n    if (!isRecording) {\n      // 在实际应用中，你需要使用语音识别API\n      // 这里我们仅模拟这个过程\n      toast.info('正在录音...');\n      setTimeout(() => {\n        setInputValue(prev => prev + \" [语音输入的文本]\");\n        setIsRecording(false);\n        toast.success('语音识别完成');\n      }, 2000);\n    } else {\n      toast.info('已停止录音');\n    }\n  };\n  const clearImage = () => {\n    setImageUrl(undefined);\n  };\n  const getModeLabel = () => {\n    switch (mode) {\n      case 'agent':\n        return '智能体模式';\n      case 'chat':\n        return '对话模式';\n      case 'manual':\n        return '手动模式';\n      default:\n        return '智能体模式';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex flex-col h-full ${isDarkMode ? 'bg-gray-900 text-gray-200' : 'bg-white text-gray-800'}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `px-3 py-2.5 flex justify-between items-center ${isDarkMode ? 'bg-gray-800 border-b border-gray-700' : 'bg-gray-50 border-b border-gray-200'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative mr-2\",\n          ref: modelDropdownRef,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `h-7 text-xs rounded flex items-center px-2 ${isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'}`,\n            onClick: () => setIsModelDropdownOpen(!isModelDropdownOpen),\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3.5 h-3.5 mr-1.5\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 15\n            }, this), selectedModel, /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3 h-3 ml-1\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M19 9l-7 7-7-7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this), isModelDropdownOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `absolute left-0 mt-1 w-48 rounded-md shadow-lg z-10 ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"py-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'claude-3.7-sonnet' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('claude-3.7-sonnet');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"claude-3.7-sonnet\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'claude-3-opus' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('claude-3-opus');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"claude-3-opus\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${selectedModel === 'gpt-4' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setSelectedModel('gpt-4');\n                  setIsModelDropdownOpen(false);\n                },\n                children: \"gpt-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative\",\n          ref: modeDropdownRef,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `h-7 text-xs rounded flex items-center px-2 ${isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'}`,\n            onClick: () => setIsModeDropdownOpen(!isModeDropdownOpen),\n            children: [getModeLabel(), /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3 h-3 ml-1\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M19 9l-7 7-7-7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this), isModeDropdownOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `absolute left-0 mt-1 w-32 rounded-md shadow-lg z-10 ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"py-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${mode === 'agent' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setMode('agent');\n                  setIsModeDropdownOpen(false);\n                },\n                children: \"\\u667A\\u80FD\\u4F53\\u6A21\\u5F0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${mode === 'chat' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setMode('chat');\n                  setIsModeDropdownOpen(false);\n                },\n                children: \"\\u5BF9\\u8BDD\\u6A21\\u5F0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `block px-4 py-2 text-xs w-full text-left ${mode === 'manual' ? isDarkMode ? 'bg-gray-700' : 'bg-gray-100' : ''}`,\n                onClick: () => {\n                  setMode('manual');\n                  setIsModeDropdownOpen(false);\n                },\n                children: \"\\u624B\\u52A8\\u6A21\\u5F0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `flex-1 overflow-y-auto ${isDarkMode ? 'bg-gray-900' : 'bg-white'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-4 space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(AnimatePresence, {\n          children: [messages.map(message => /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              opacity: 0,\n              y: 10\n            },\n            animate: {\n              opacity: 1,\n              y: 0\n            },\n            transition: {\n              duration: 0.3\n            },\n            className: \"max-w-full\",\n            children: /*#__PURE__*/_jsxDEV(MessageBubble, {\n              message: message,\n              isDarkMode: isDarkMode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 17\n            }, this)\n          }, message.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 15\n          }, this)), status === 'thinking' && /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              opacity: 0\n            },\n            animate: {\n              opacity: 1\n            },\n            exit: {\n              opacity: 0\n            },\n            className: \"max-w-full\",\n            children: /*#__PURE__*/_jsxDEV(ThinkingIndicator, {\n              isDarkMode: isDarkMode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), imageUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `px-3 pt-2 ${isDarkMode ? 'bg-gray-900 border-t border-gray-800' : 'bg-white border-t border-gray-100'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative inline-block\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: imageUrl,\n          alt: \"Uploaded\",\n          className: \"max-h-32 rounded-md border border-gray-300\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"absolute top-1 right-1 bg-gray-800 bg-opacity-70 text-white rounded-full p-1\",\n          onClick: clearImage,\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M6 18L18 6M6 6l12 12\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `px-3 pt-2 pb-3 ${isDarkMode ? 'bg-gray-900 border-t border-gray-800' : 'bg-white border-t border-gray-100'}`,\n      children: [references.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex flex-wrap gap-1 mb-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs mt-0.5\",\n          children: \"\\u5F15\\u7528\\u6587\\u4EF6:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 13\n        }, this), references.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `text-xs rounded px-1.5 py-0.5 flex items-center ${isDarkMode ? 'bg-blue-900 text-blue-200' : 'bg-blue-100 text-blue-800'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: file\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleRemoveReference(file),\n            className: \"ml-1 text-opacity-70 hover:text-opacity-100\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-3 h-3\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M6 18L18 6M6 6l12 12\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 17\n          }, this)]\n        }, file, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `rounded-lg overflow-hidden ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-300'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: inputRef,\n          value: inputValue,\n          onChange: handleInputChange,\n          onKeyDown: handleKeyDown,\n          placeholder: `向 AI 提问... (按 @ 引用文件)`,\n          disabled: status !== 'idle',\n          className: `w-full px-3 py-2.5 resize-none outline-none ${isDarkMode ? 'bg-gray-800 text-gray-200 placeholder-gray-500' : 'bg-white text-gray-800 placeholder-gray-400'}`,\n          rows: 1,\n          style: {\n            minHeight: '44px',\n            maxHeight: '200px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 509,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex justify-between items-center px-3 py-2 ${isDarkMode ? 'bg-gray-800 border-t border-gray-700' : 'bg-gray-50 border-t border-gray-200'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500\",\n              children: \"\\u6309 Enter \\u53D1\\u9001\\uFF0CShift+Enter \\u6362\\u884C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setShowReferenceSelector(!showReferenceSelector),\n              className: `text-xs flex items-center ${isDarkMode ? 'text-gray-400 hover:text-gray-300' : 'text-gray-600 hover:text-gray-700'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-3.5 h-3.5 mr-1\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 544,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 543,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u5F15\\u7528\\u6587\\u4EF6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 546,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              ref: fileInputRef,\n              onChange: handleImageUpload,\n              accept: \"image/*\",\n              className: \"hidden\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 550,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                var _fileInputRef$current;\n                return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n              },\n              className: `text-xs flex items-center ${isDarkMode ? 'text-gray-400 hover:text-gray-300' : 'text-gray-600 hover:text-gray-700'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-3.5 h-3.5 mr-1\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 566,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 565,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u4E0A\\u4F20\\u56FE\\u7247\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 568,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 557,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleVoiceInput,\n              className: `text-xs flex items-center ${isRecording ? 'text-red-500' : isDarkMode ? 'text-gray-400 hover:text-gray-300' : 'text-gray-600 hover:text-gray-700'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-3.5 h-3.5 mr-1\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 583,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 582,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: isRecording ? \"录音中...\" : \"语音输入\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 585,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 572,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleSendMessage,\n            disabled: !inputValue.trim() && !imageUrl || status !== 'idle',\n            className: `h-7 px-3 text-sm font-medium ${!inputValue.trim() && !imageUrl || status !== 'idle' ? 'opacity-50 cursor-not-allowed' : ''} ${isDarkMode ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-600 hover:bg-blue-700 text-white'}`,\n            children: \"\\u53D1\\u9001\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 589,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 9\n      }, this), showReferenceSelector && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `mt-1 rounded-md border ${isDarkMode ? 'border-gray-700 bg-gray-800' : 'border-gray-300 bg-white'} max-h-48 overflow-y-auto shadow-lg`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs font-medium mb-2 px-2\",\n            children: \"\\u9009\\u62E9\\u8981\\u5F15\\u7528\\u7684\\u6587\\u4EF6\\uFF1A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: availableFiles.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `px-3 py-1.5 text-xs rounded cursor-pointer ${isDarkMode ? 'hover:bg-gray-700' : 'hover:bg-gray-100'}`,\n              onClick: () => handleReferenceSelect(file),\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: \"w-3.5 h-3.5 mr-2 text-gray-500\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    strokeWidth: 2,\n                    d: \"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 629,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 628,\n                  columnNumber: 23\n                }, this), file]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 627,\n                columnNumber: 21\n              }, this)\n            }, file, false, {\n              fileName: _jsxFileName,\n              lineNumber: 618,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 616,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 609,\n        columnNumber: 11\n      }, this), status === 'error' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-red-500 mt-1 ml-2\",\n        children: \"\\u53D1\\u9001\\u5931\\u8D25\\uFF0C\\u8BF7\\u91CD\\u8BD5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 641,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 277,\n    columnNumber: 5\n  }, this);\n};\n_s(AIChat, \"H/aPlbToWphz6lcZ1EWQzYGhSYI=\");\n_c = AIChat;\nexport default AIChat;\nvar _c;\n$RefreshReg$(_c, \"AIChat\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Button","motion","AnimatePresence","MessageBubble","ThinkingIndicator","toast","jsxDEV","_jsxDEV","AIChat","initialMessages","onSendMessage","_s","messages","setMessages","inputValue","setInputValue","status","setStatus","isDarkMode","setIsDarkMode","selectedModel","setSelectedModel","mode","setMode","isModelDropdownOpen","setIsModelDropdownOpen","isModeDropdownOpen","setIsModeDropdownOpen","references","setReferences","showReferenceSelector","setShowReferenceSelector","imageUrl","setImageUrl","undefined","isRecording","setIsRecording","availableFiles","setAvailableFiles","messagesEndRef","inputRef","modelDropdownRef","modeDropdownRef","fileInputRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","scrollIntoView","behavior","style","height","Math","min","scrollHeight","generateId","Date","now","toString","random","substring","handleSendMessage","trim","userMessage","id","role","content","timestamp","length","prev","response","simulateResponse","assistantMessage","error","console","errorMessage","setTimeout","message","refs","img","Promise","resolve","responses","floor","join","handleInputChange","e","value","endsWith","handleKeyDown","key","shiftKey","preventDefault","handleReferenceSelect","file","includes","success","handleRemoveReference","filter","ref","handleImageUpload","_e$target$files","files","tempUrl","URL","createObjectURL","name","handleVoiceInput","window","info","clearImage","getModeLabel","className","children","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","map","div","initial","opacity","y","animate","transition","duration","exit","src","alt","onChange","onKeyDown","placeholder","disabled","rows","minHeight","maxHeight","type","accept","_fileInputRef$current","click","_c","$RefreshReg$"],"sources":["/home/devbox/project/src/components/features/ai-chat/ai-chat.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Button } from '../../ui/button';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from './message-bubble';\nimport ThinkingIndicator from './thinking-indicator';\nimport { toast } from 'sonner';\n\n// 定义消息类型\nexport interface Message {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n  references?: string[]; // 引用的文件或资源\n  imageUrl?: string; // 图片URL\n}\n\n// 定义AI模型类型\ntype AIModel = 'claude-3.7-sonnet' | 'claude-3-opus' | 'gpt-4'; \n\n// 定义AI模式类型\ntype AIMode = 'agent' | 'chat' | 'manual';\n\ninterface AIChatProps {\n  initialMessages?: Message[];\n  onSendMessage?: (message: string, references?: string[], imageUrl?: string) => Promise<string>;\n}\n\nconst AIChat: React.FC<AIChatProps> = ({ \n  initialMessages = [], \n  onSendMessage \n}) => {\n  const [messages, setMessages] = useState<Message[]>(initialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [status, setStatus] = useState<'idle' | 'thinking' | 'responding' | 'error'>('idle');\n  const [isDarkMode, setIsDarkMode] = useState(false);\n  const [selectedModel, setSelectedModel] = useState<AIModel>('claude-3.7-sonnet');\n  const [mode, setMode] = useState<AIMode>('agent');\n  const [isModelDropdownOpen, setIsModelDropdownOpen] = useState(false);\n  const [isModeDropdownOpen, setIsModeDropdownOpen] = useState(false);\n  const [references, setReferences] = useState<string[]>([]);\n  const [showReferenceSelector, setShowReferenceSelector] = useState(false);\n  const [imageUrl, setImageUrl] = useState<string | undefined>(undefined);\n  const [isRecording, setIsRecording] = useState(false);\n  const [availableFiles, setAvailableFiles] = useState([\n    'workspace.txt', \n    'project.json', \n    'README.md', \n    'src/components/features/plan-tree/plan-tree.tsx'\n  ]);\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const modelDropdownRef = useRef<HTMLDivElement>(null);\n  const modeDropdownRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // 处理点击外部关闭下拉菜单\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (modelDropdownRef.current && !modelDropdownRef.current.contains(event.target as Node)) {\n        setIsModelDropdownOpen(false);\n      }\n      if (modeDropdownRef.current && !modeDropdownRef.current.contains(event.target as Node)) {\n        setIsModeDropdownOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  // 自动滚动到最新消息\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages]);\n\n  // 自动调整输入框高度\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n      inputRef.current.style.height = `${Math.min(inputRef.current.scrollHeight, 200)}px`;\n    }\n  }, [inputValue]);\n\n  const generateId = () => {\n    return Date.now().toString(36) + Math.random().toString(36).substring(2);\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim() && !imageUrl && status !== 'idle') return;\n    \n    // 创建用户消息\n    const userMessage: Message = {\n      id: generateId(),\n      role: 'user',\n      content: inputValue,\n      timestamp: new Date(),\n      references: references.length > 0 ? [...references] : undefined,\n      imageUrl\n    };\n    \n    // 更新状态并清空输入\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setReferences([]);\n    setImageUrl(undefined);\n    setShowReferenceSelector(false);\n    if (inputRef.current) {\n      inputRef.current.style.height = 'auto';\n    }\n    setStatus('thinking');\n    \n    try {\n      // 如果没有提供onSendMessage回调，使用模拟响应\n      const response = onSendMessage \n        ? await onSendMessage(inputValue, references, imageUrl) \n        : await simulateResponse(inputValue, references, imageUrl);\n      \n      // 添加AI回复\n      const assistantMessage: Message = {\n        id: generateId(),\n        role: 'assistant',\n        content: response,\n        timestamp: new Date()\n      };\n      \n      setMessages(prev => [...prev, assistantMessage]);\n      setStatus('idle');\n    } catch (error) {\n      console.error('Failed to get AI response:', error);\n      setStatus('error');\n      \n      // 添加错误消息\n      const errorMessage: Message = {\n        id: generateId(),\n        role: 'system',\n        content: '抱歉，发生了错误。请稍后再试。',\n        timestamp: new Date()\n      };\n      \n      setMessages(prev => [...prev, errorMessage]);\n      setTimeout(() => setStatus('idle'), 3000);\n    }\n  };\n\n  // 模拟AI响应，仅用于演示\n  const simulateResponse = async (message: string, refs?: string[], img?: string): Promise<string> => {\n    // 返回模拟的响应\n    return new Promise((resolve) => {\n      const responses = [\n        \"我理解你的问题。让我帮你分析一下...\",\n        \"这是一个很好的问题。根据我的分析...\",\n        \"我可以协助你解决这个问题。首先，你需要...\",\n        \"让我思考一下最佳的解决方案。\",\n        \"根据最新的研究和最佳实践，我建议...\"\n      ];\n      \n      let response = responses[Math.floor(Math.random() * responses.length)];\n      \n      if (message) {\n        response += ` 你的问题是关于\"${message}\"的。`;\n      }\n      \n      // 如果有引用文件，添加相关内容\n      if (refs && refs.length > 0) {\n        response += ` 我已查看了你引用的文件: ${refs.join(', ')}。`;\n      }\n\n      // 如果有图片，添加相关内容\n      if (img) {\n        response += \" 我已分析了你上传的图片。\";\n      }\n      \n      if (mode === 'agent') {\n        response += \" 作为智能体模式，我会主动帮你执行任务和提供解决方案。\";\n      } else if (mode === 'chat') {\n        response += \" 作为对话模式，我会回答你的问题，但不会主动执行任务。\";\n      } else {\n        response += \" 作为手动模式，我需要你指导我该如何进行操作。\";\n      }\n      \n      // 模拟网络延迟\n      setTimeout(() => {\n        resolve(response);\n      }, 1500);\n    });\n  };\n\n  // 处理输入值变化\n  const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const value = e.target.value;\n    setInputValue(value);\n    \n    // 检测是否输入了@符号\n    if (value.endsWith('@') && !showReferenceSelector) {\n      setShowReferenceSelector(true);\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    } else if (e.key === '@') {\n      setShowReferenceSelector(true);\n    } else if (e.key === 'Escape') {\n      setShowReferenceSelector(false);\n      setIsModelDropdownOpen(false);\n      setIsModeDropdownOpen(false);\n    }\n  };\n  \n  const handleReferenceSelect = (file: string) => {\n    if (!references.includes(file)) {\n      setReferences(prev => [...prev, file]);\n      toast.success(`已引用 ${file}`);\n    }\n    setShowReferenceSelector(false);\n  };\n  \n  const handleRemoveReference = (file: string) => {\n    setReferences(prev => prev.filter(ref => ref !== file));\n  };\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      // 在实际应用中，你可能需要将文件上传到服务器并获取URL\n      // 这里我们仅模拟这个过程，生成一个临时的对象URL\n      const tempUrl = URL.createObjectURL(file);\n      setImageUrl(tempUrl);\n      toast.success(`已上传图片: ${file.name}`);\n    }\n  };\n\n  const handleVoiceInput = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      toast.error('您的浏览器不支持语音识别功能');\n      return;\n    }\n\n    setIsRecording(!isRecording);\n    \n    if (!isRecording) {\n      // 在实际应用中，你需要使用语音识别API\n      // 这里我们仅模拟这个过程\n      toast.info('正在录音...');\n      setTimeout(() => {\n        setInputValue(prev => prev + \" [语音输入的文本]\");\n        setIsRecording(false);\n        toast.success('语音识别完成');\n      }, 2000);\n    } else {\n      toast.info('已停止录音');\n    }\n  };\n\n  const clearImage = () => {\n    setImageUrl(undefined);\n  };\n\n  const getModeLabel = () => {\n    switch (mode) {\n      case 'agent': return '智能体模式';\n      case 'chat': return '对话模式';\n      case 'manual': return '手动模式';\n      default: return '智能体模式';\n    }\n  };\n\n  return (\n    <div className={`flex flex-col h-full ${isDarkMode ? 'bg-gray-900 text-gray-200' : 'bg-white text-gray-800'}`}>\n      {/* Cursor风格头部 */}\n      <div className={`px-3 py-2.5 flex justify-between items-center ${isDarkMode ? 'bg-gray-800 border-b border-gray-700' : 'bg-gray-50 border-b border-gray-200'}`}>\n        <div className=\"flex items-center\">\n          {/* 模型选择下拉菜单 */}\n          <div className=\"relative mr-2\" ref={modelDropdownRef}>\n            <button \n              className={`h-7 text-xs rounded flex items-center px-2 ${\n                isDarkMode \n                  ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' \n                  : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'\n              }`}\n              onClick={() => setIsModelDropdownOpen(!isModelDropdownOpen)}\n            >\n              <svg className=\"w-3.5 h-3.5 mr-1.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n              </svg>\n              {selectedModel}\n              <svg className=\"w-3 h-3 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n              </svg>\n            </button>\n            \n            {isModelDropdownOpen && (\n              <div className={`absolute left-0 mt-1 w-48 rounded-md shadow-lg z-10 ${\n                isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'\n              }`}>\n                <div className=\"py-1\">\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'claude-3.7-sonnet' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('claude-3.7-sonnet');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    claude-3.7-sonnet\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'claude-3-opus' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('claude-3-opus');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    claude-3-opus\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      selectedModel === 'gpt-4' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setSelectedModel('gpt-4');\n                      setIsModelDropdownOpen(false);\n                    }}\n                  >\n                    gpt-4\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* 模式选择下拉菜单 */}\n          <div className=\"relative\" ref={modeDropdownRef}>\n            <button \n              className={`h-7 text-xs rounded flex items-center px-2 ${\n                isDarkMode \n                  ? 'bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-600' \n                  : 'bg-white hover:bg-gray-100 text-gray-700 border border-gray-300'\n              }`}\n              onClick={() => setIsModeDropdownOpen(!isModeDropdownOpen)}\n            >\n              {getModeLabel()}\n              <svg className=\"w-3 h-3 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n              </svg>\n            </button>\n            \n            {isModeDropdownOpen && (\n              <div className={`absolute left-0 mt-1 w-32 rounded-md shadow-lg z-10 ${\n                isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'\n              }`}>\n                <div className=\"py-1\">\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      mode === 'agent' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setMode('agent');\n                      setIsModeDropdownOpen(false);\n                    }}\n                  >\n                    智能体模式\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      mode === 'chat' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setMode('chat');\n                      setIsModeDropdownOpen(false);\n                    }}\n                  >\n                    对话模式\n                  </button>\n                  <button\n                    className={`block px-4 py-2 text-xs w-full text-left ${\n                      mode === 'manual' \n                        ? (isDarkMode ? 'bg-gray-700' : 'bg-gray-100') \n                        : ''\n                    }`}\n                    onClick={() => {\n                      setMode('manual');\n                      setIsModeDropdownOpen(false);\n                    }}\n                  >\n                    手动模式\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      \n      {/* 消息历史区域 - Cursor风格 */}\n      <div className={`flex-1 overflow-y-auto ${isDarkMode ? 'bg-gray-900' : 'bg-white'}`}>\n        <div className=\"px-4 py-4 space-y-6\">\n          <AnimatePresence>\n            {messages.map((message) => (\n              <motion.div\n                key={message.id}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.3 }}\n                className=\"max-w-full\"\n              >\n                <MessageBubble message={message} isDarkMode={isDarkMode} />\n              </motion.div>\n            ))}\n            \n            {status === 'thinking' && (\n              <motion.div\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                className=\"max-w-full\"\n              >\n                <ThinkingIndicator isDarkMode={isDarkMode} />\n              </motion.div>\n            )}\n          </AnimatePresence>\n          \n          {/* 用于自动滚动的引用元素 */}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n      \n      {/* 显示上传的图片预览 */}\n      {imageUrl && (\n        <div className={`px-3 pt-2 ${\n          isDarkMode \n            ? 'bg-gray-900 border-t border-gray-800' \n            : 'bg-white border-t border-gray-100'\n        }`}>\n          <div className=\"relative inline-block\">\n            <img src={imageUrl} alt=\"Uploaded\" className=\"max-h-32 rounded-md border border-gray-300\" />\n            <button \n              className=\"absolute top-1 right-1 bg-gray-800 bg-opacity-70 text-white rounded-full p-1\"\n              onClick={clearImage}\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n      \n      {/* 底部输入区域 - Cursor风格 */}\n      <div className={`px-3 pt-2 pb-3 ${\n        isDarkMode \n          ? 'bg-gray-900 border-t border-gray-800' \n          : 'bg-white border-t border-gray-100'\n      }`}>\n        {/* 显示已选择的引用文件 */}\n        {references.length > 0 && (\n          <div className={`flex flex-wrap gap-1 mb-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-700'}`}>\n            <span className=\"text-xs mt-0.5\">引用文件:</span>\n            {references.map(file => (\n              <div \n                key={file} \n                className={`text-xs rounded px-1.5 py-0.5 flex items-center ${\n                  isDarkMode \n                    ? 'bg-blue-900 text-blue-200' \n                    : 'bg-blue-100 text-blue-800'\n                }`}\n              >\n                <span>{file}</span>\n                <button \n                  onClick={() => handleRemoveReference(file)}\n                  className=\"ml-1 text-opacity-70 hover:text-opacity-100\"\n                >\n                  <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n            ))}\n          </div>\n        )}\n        \n        <div className={`rounded-lg overflow-hidden ${\n          isDarkMode \n            ? 'bg-gray-800 border border-gray-700' \n            : 'bg-white border border-gray-300'\n        }`}>\n          {/* 文本输入区域 */}\n          <textarea\n            ref={inputRef}\n            value={inputValue}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder={`向 AI 提问... (按 @ 引用文件)`}\n            disabled={status !== 'idle'}\n            className={`w-full px-3 py-2.5 resize-none outline-none ${\n              isDarkMode \n                ? 'bg-gray-800 text-gray-200 placeholder-gray-500' \n                : 'bg-white text-gray-800 placeholder-gray-400'\n            }`}\n            rows={1}\n            style={{ minHeight: '44px', maxHeight: '200px' }}\n          />\n          \n          {/* 底部操作栏 */}\n          <div className={`flex justify-between items-center px-3 py-2 ${\n            isDarkMode \n              ? 'bg-gray-800 border-t border-gray-700' \n              : 'bg-gray-50 border-t border-gray-200'\n          }`}>\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"text-xs text-gray-500\">按 Enter 发送，Shift+Enter 换行</div>\n              \n              {/* 引用文件按钮 */}\n              <button\n                onClick={() => setShowReferenceSelector(!showReferenceSelector)}\n                className={`text-xs flex items-center ${\n                  isDarkMode \n                    ? 'text-gray-400 hover:text-gray-300' \n                    : 'text-gray-600 hover:text-gray-700'\n                }`}\n              >\n                <svg className=\"w-3.5 h-3.5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                </svg>\n                <span>引用文件</span>\n              </button>\n              \n              {/* 上传图片按钮 */}\n              <input \n                type=\"file\" \n                ref={fileInputRef}\n                onChange={handleImageUpload}\n                accept=\"image/*\"\n                className=\"hidden\"\n              />\n              <button\n                onClick={() => fileInputRef.current?.click()}\n                className={`text-xs flex items-center ${\n                  isDarkMode \n                    ? 'text-gray-400 hover:text-gray-300' \n                    : 'text-gray-600 hover:text-gray-700'\n                }`}\n              >\n                <svg className=\"w-3.5 h-3.5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                </svg>\n                <span>上传图片</span>\n              </button>\n              \n              {/* 语音转文字按钮 */}\n              <button\n                onClick={handleVoiceInput}\n                className={`text-xs flex items-center ${\n                  isRecording \n                    ? 'text-red-500' \n                    : isDarkMode \n                      ? 'text-gray-400 hover:text-gray-300' \n                      : 'text-gray-600 hover:text-gray-700'\n                }`}\n              >\n                <svg className=\"w-3.5 h-3.5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                </svg>\n                <span>{isRecording ? \"录音中...\" : \"语音输入\"}</span>\n              </button>\n            </div>\n            \n            <Button \n              onClick={handleSendMessage}\n              disabled={(!inputValue.trim() && !imageUrl) || status !== 'idle'}\n              className={`h-7 px-3 text-sm font-medium ${\n                (!inputValue.trim() && !imageUrl) || status !== 'idle'\n                  ? 'opacity-50 cursor-not-allowed'\n                  : ''\n              } ${\n                isDarkMode \n                  ? 'bg-blue-600 hover:bg-blue-700 text-white' \n                  : 'bg-blue-600 hover:bg-blue-700 text-white'\n              }`}\n            >\n              发送\n            </Button>\n          </div>\n        </div>\n        \n        {/* 文件引用选择器 - Cursor风格 */}\n        {showReferenceSelector && (\n          <div className={`mt-1 rounded-md border ${\n            isDarkMode \n              ? 'border-gray-700 bg-gray-800' \n              : 'border-gray-300 bg-white'\n          } max-h-48 overflow-y-auto shadow-lg`}>\n            <div className=\"p-2\">\n              <div className=\"text-xs font-medium mb-2 px-2\">选择要引用的文件：</div>\n              <div>\n                {availableFiles.map(file => (\n                  <div \n                    key={file}\n                    className={`px-3 py-1.5 text-xs rounded cursor-pointer ${\n                      isDarkMode \n                        ? 'hover:bg-gray-700' \n                        : 'hover:bg-gray-100'\n                    }`}\n                    onClick={() => handleReferenceSelect(file)}\n                  >\n                    <div className=\"flex items-center\">\n                      <svg className=\"w-3.5 h-3.5 mr-2 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                      {file}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n        \n        {status === 'error' && (\n          <div className=\"text-xs text-red-500 mt-1 ml-2\">发送失败，请重试</div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AIChat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}